<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 27</title>
</head>

<body>

<h2 align="center">R Code for Lecture 27 (Wednesday, November 28, 2012)</h2>
<div style="overflow:auto;"><div class="geshifilter">
  <pre class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># load data and fit models from last time</span>
wells <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">read.csv</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;ecol 563/wells.txt&quot;</span><span style="color: #009900;">&#41;</span>
out1 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">glm</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>y<span style="color: #339933;">,</span> n<span style="">-</span>y<span style="color: #009900;">&#41;</span><span style="">~</span> land.use <span style="">+</span> sewer<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">data</span>=wells<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">family</span>=<span style="color: #003399; font-weight: bold;">binomial</span><span style="color: #009900;">&#41;</span>
wells<span style="">$</span>land.use2 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">factor</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">ifelse</span><span style="color: #009900;">&#40;</span>wells<span style="">$</span>land.use <span style="">%in%</span> <span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'agri'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'undev'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'rural'</span><span style="color: #339933;">,</span> 
<span style="color: #003399; font-weight: bold;">as.character</span><span style="color: #009900;">&#40;</span>wells<span style="">$</span>land.use<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
wells<span style="">$</span>land.use3 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">factor</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">ifelse</span><span style="color: #009900;">&#40;</span>wells<span style="">$</span>land.use2 <span style="">%in%</span> <span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inst'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'recr'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'resL'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'resM'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'trans'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> 
<span style="color: #0000ff;">'mixed'</span><span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">as.character</span><span style="color: #009900;">&#40;</span>wells<span style="">$</span>land.use2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
wells<span style="">$</span>land.use4 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">factor</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">ifelse</span><span style="color: #009900;">&#40;</span>wells<span style="">$</span>land.use3 <span style="">%in%</span> <span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'resH'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'comm'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'indus'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> 
<span style="color: #0000ff;">'high.use'</span><span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">as.character</span><span style="color: #009900;">&#40;</span>wells<span style="">$</span>land.use3<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out2d <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">glm</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>y<span style="color: #339933;">,</span>n<span style="">-</span>y<span style="color: #009900;">&#41;</span><span style="">~</span>land.use4<span style="">+</span>sewer<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">data</span>=wells<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">family</span>=<span style="color: #003399; font-weight: bold;">binomial</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># predicted logits</span>
<span style="color: #003399; font-weight: bold;">predict</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># predicted probabilities</span>
<span style="color: #003399; font-weight: bold;">predict</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'response'</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># predicted means</span>
<span style="color: #003399; font-weight: bold;">predict</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'response'</span><span style="color: #009900;">&#41;</span><span style="">*</span>wells<span style="">$</span>n
ei <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">predict</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'response'</span><span style="color: #009900;">&#41;</span><span style="">*</span>wells<span style="">$</span>n
<span style="color: #666666; font-style: italic;"># expected number of contaminated and uncontaminated wells</span>
Ei <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>ei<span style="color: #339933;">,</span> wells<span style="">$</span>n<span style="">-</span>ei<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># observed number of contaminated and uncontaminated wells</span>
Oi <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>wells<span style="">$</span>y<span style="color: #339933;">,</span> wells<span style="">$</span>n<span style="">-</span>wells<span style="">$</span>y<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Pearson statistic</span>
<span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>Oi<span style="">-</span>Ei<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>Ei<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># p-value of Pearson statistic</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #003399; font-weight: bold;">pchisq</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>Oi<span style="">-</span>Ei<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>Ei<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">16</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># G-test statistic</span>
<span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">ifelse</span><span style="color: #009900;">&#40;</span>Oi<span style="">==</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="">*</span>Oi<span style="">*</span><span style="color: #003399; font-weight: bold;">log</span><span style="color: #009900;">&#40;</span>Oi<span style="">/</span>Ei<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># residual deviance = G-test statistic</span>
<span style="color: #003399; font-weight: bold;">deviance</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># degrees of freedom for G-test</span>
<span style="color: #003399; font-weight: bold;">df.residual</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># deviance goodness of fit</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #003399; font-weight: bold;">pchisq</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">deviance</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">df.residual</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># 35% of predicted counts are less than 5</span>
<span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span>Ei<span style="">&lt;=</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span><span style="">/</span>length<span style="color: #009900;">&#40;</span>Ei<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># function for parametric bootstrap</span>
sim.func <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
obs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">sapply</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #003399; font-weight: bold;">nrow</span><span style="color: #009900;">&#40;</span>wells<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <span style="color: #003399; font-weight: bold;">rbinom</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="">prob</span>=<span style="color: #003399; font-weight: bold;">fitted</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>
  size=wells<span style="">$</span>n<span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
my.glm <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">glm</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>obs<span style="color: #339933;">,</span>n<span style="">-</span>obs<span style="color: #009900;">&#41;</span><span style="">~</span>land.use4 <span style="">+</span> sewer<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">data</span>=wells<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">family</span>=<span style="color: #003399; font-weight: bold;">binomial</span><span style="color: #009900;">&#41;</span>
ei <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">fitted</span><span style="color: #009900;">&#40;</span>my.glm<span style="color: #009900;">&#41;</span><span style="">*</span>wells<span style="">$</span>n
Ei <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>ei<span style="color: #339933;">,</span> wells<span style="">$</span>n<span style="">-</span>ei<span style="color: #009900;">&#41;</span>
Oi <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>obs<span style="color: #339933;">,</span> wells<span style="">$</span>n<span style="">-</span>obs<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># pearson test</span>
pearson <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>Oi<span style="">-</span>Ei<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>Ei<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># G-test</span>
gtest <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">ifelse</span><span style="color: #009900;">&#40;</span>Oi<span style="">==</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="">*</span>Oi<span style="">*</span><span style="color: #003399; font-weight: bold;">log</span><span style="color: #009900;">&#40;</span>Oi<span style="">/</span>Ei<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># residual deviance</span>
dev <span style="">&lt;- </span><span style="color: #003399; font-weight: bold;">deviance</span><span style="color: #009900;">&#40;</span>my.glm<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># return residual deviance</span>
<span style="color: #003399; font-weight: bold;">dev</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain 999 residual deviances from model</span>
sims <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">replicate</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">999</span><span style="color: #339933;">,</span> sim.func<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># append actual residual deviance to make 1000</span>
sims <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span>sims<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">deviance</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># proportion of simulated values that exceed actual value</span>
<span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span>sims<span style="">&gt;=</span><span style="color: #003399; font-weight: bold;">deviance</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">/</span>length<span style="color: #009900;">&#40;</span>sims<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># if ratio of residual deviance to df &gt; 1, overdispersion?</span>
<span style="color: #003399; font-weight: bold;">deviance</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="">/</span>df.residual<span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>Oi<span style="">-</span>Ei<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>Ei<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># if ratio of Pearson deviance to df &gt; 1, overdispersion?</span>
<span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>Oi<span style="">-</span>Ei<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>Ei<span style="color: #009900;">&#41;</span><span style="">/</span>df.residual<span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># if overdispersion is real and cannot be fixed we can fit quasi-binomial</span>
<span style="color: #666666; font-style: italic;"># quasi-binomial model</span>
out2d.quasi <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">glm</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">cbind</span><span style="color: #009900;">&#40;</span>y<span style="color: #339933;">,</span>n<span style="">-</span>y<span style="color: #009900;">&#41;</span><span style="">~</span>land.use4<span style="">+</span>sewer<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">data</span>=wells<span style="color: #339933;">,</span> <span style="color: #003399; font-weight: bold;">family</span>=<span style="color: #003399; font-weight: bold;">quasibinomial</span><span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">summary</span><span style="color: #009900;">&#40;</span>out2d.quasi<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># same estimates as binomial but different standard errors</span>
<span style="color: #003399; font-weight: bold;">summary</span><span style="color: #009900;">&#40;</span>out2d.quasi<span style="color: #009900;">&#41;</span><span style="">$</span>coefficients
<span style="color: #003399; font-weight: bold;">summary</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="">$</span>coefficients
&nbsp;
<span style="color: #666666; font-style: italic;"># the standard errors are obtained from the Pearson deviance</span>
phi <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">sum</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>Oi<span style="">-</span>Ei<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>Ei<span style="color: #009900;">&#41;</span><span style="">/</span>df.residual<span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
phi
<span style="color: #003399; font-weight: bold;">sqrt</span><span style="color: #009900;">&#40;</span>phi<span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #003399; font-weight: bold;">summary</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="">$</span>coefficients<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># add continuous predictors to the logistic regression model</span>
out2g <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">update</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> .<span style="">~</span>.<span style="">+</span>nitrate<span style="color: #009900;">&#41;</span>
out2h <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">update</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> .<span style="">~</span>.<span style="">+</span>chloride<span style="color: #009900;">&#41;</span>
out2i <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">update</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> .<span style="">~</span>.<span style="">+</span>chloride<span style="">+</span>nitrate<span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">AIC</span><span style="color: #009900;">&#40;</span>out2g<span style="color: #339933;">,</span> out2h<span style="color: #339933;">,</span> out2i<span style="color: #339933;">,</span> out2d<span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">anova</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> out2g<span style="color: #339933;">,</span> test=<span style="color: #0000ff;">'Chisq'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># is there a significant interaction?</span>
out2j<span style="">&lt;-</span><span style="color: #003399; font-weight: bold;">update</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span> .<span style="">~</span>. <span style="">+</span>land.use4<span style="">:</span>sewer<span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">anova</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #339933;">,</span>out2j<span style="color: #339933;">,</span> test=<span style="color: #0000ff;">'Chisq'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtaining odds ratios</span>
<span style="color: #666666; font-style: italic;"># OR for contamination: mixed versus high use</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># OR for contamination: high use versus mixed</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="">-</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># OR for contamination: sewers present versus sewers absent</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># OR for contamination: mixed versus rural</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">-</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># OR for contamination for a one unit change in nitrate</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2g<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># OR for contamination for a three unit change in nitrate</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">3</span><span style="">*</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2g<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># confidence intervals for the regression parameters</span>
<span style="color: #003399; font-weight: bold;">confint</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
out.ci <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">confint</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># 95% confidence intervals for the odds ratios</span>
<span style="color: #666666; font-style: italic;"># mixed versus high and rural versus high</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span>out.ci<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># OR for contamination: high use versus mixed</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="">-</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># 95% confidence interval for that odds ratio</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="">-</span>out.ci<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># OR for contamination: high use versus rural</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="">-</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># 95% confidence interval for that odds ratio</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span><span style="">-</span>out.ci<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># log odds ratio for contamination: mixed versus rural</span>
est <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="">%*%</span><span style="color: #003399; font-weight: bold;">coef</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># standard error of that log odds ratio</span>
se <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">sqrt</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="">%*%</span><span style="color: #003399; font-weight: bold;">vcov</span><span style="color: #009900;">&#40;</span>out2d<span style="color: #009900;">&#41;</span><span style="">%*%</span><span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># 95% confidence interval for the log odds ratio</span>
est <span style="">+</span> <span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">qnorm</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #003399; font-weight: bold;">qnorm</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.975</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">*</span>se
<span style="color: #666666; font-style: italic;"># 95% confidence interval for the odds ratio: mixed versus rural</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span>est <span style="">+</span> <span style="color: #003399; font-weight: bold;">c</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">qnorm</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #003399; font-weight: bold;">qnorm</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.975</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">*</span>se<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># point estimate</span>
<span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span>est<span style="color: #009900;">&#41;</span></pre></div></div><p>Created by Pretty R at inside-R.org</p>


</body>
</html>
