<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 8</title>
</head>

<body>

<h2 align="center">R Code for Lecture 8 (Wednesday, September 19, 2012)</h2>
<div style="overflow:auto;"><div class="geshifilter">
  <pre class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># 4-factor design with crossed random effects</span>
nitro <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399; font-weight: bold;">read.csv</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'ecol 563/nitro.csv'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lme4"><span style="">lme4</span></a><span style="color: #009900;">&#41;</span>
mod3.lmer <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">lmer</span><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">*</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>func<span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">|</span>block<span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">|</span>phy<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># no p-values</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>mod3.lmer<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># obtain credible intervals for effects</span>
out.mcmc <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">mcmcsamp</span><span style="color: #009900;">&#40;</span>mod3.lmer<span style="color: #339933;">,</span>n=<span style="color: #cc66cc;">10000</span><span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">HPDinterval</span><span style="color: #009900;">&#40;</span>out.mcmc<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># effects model</span>
mod3.lm <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">*</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>mod3.lm<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># cell means model</span>
mod3.lm <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">:</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># we get estimates and standard errors of means</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>mod3.lm<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># variance-covariance matrix of means</span>
<a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>mod3.lm<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># effect estimaters</span>
mod3.lm <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>mod3.lm<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># means for lh, effects for n</span>
mod3.lm <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>mod3.lm<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain means and their covariance matrix separately for different values of func and p</span>
<a href="http://inside-r.org/r-doc/nlme/fixef"><span style="color: #003399; font-weight: bold;">fixef</span></a><span style="color: #009900;">&#40;</span>mod3.lmer<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># Method 1: create a matrix with 4 rows: one row for each lh and n combination</span>
cmat <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>func<span style="color: #339933;">,</span>p<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399; font-weight: bold;">rbind</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span>func<span style="">==</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span>p<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span>func<span style="">==</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span>p<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>func<span style="">==</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span>p<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>func<span style="">==</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span>p<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
cmat<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Method 2: write a function of all 4 factors that matches the R coding scheme</span>
cmat2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #339933;">,</span>n<span style="color: #339933;">,</span>func<span style="color: #339933;">,</span>p<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="">==</span><span style="color: #0000ff;">'NP'</span><span style="color: #339933;">,</span> n<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> func<span style="">==</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span> p<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="">==</span><span style="color: #0000ff;">'NP'</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>n<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># produce a matrix that contains all combinations of lh and n</span>
g <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a>=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>nitro<span style="">$</span>lh<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> n=<span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># evaluate function on this matrix</span>
<a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>g<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> cmat2<span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># transpose result</span>
<a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>g<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> cmat2<span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># write this as a function of func and p</span>
cmat3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>func<span style="color: #339933;">,</span>p<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>g<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> cmat2<span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>func<span style="color: #339933;">,</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># we get the same result as above</span>
cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#obtain estimates of the means</span>
ests <span style="">&lt;-</span> cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/nlme/fixef"><span style="color: #003399; font-weight: bold;">fixef</span></a><span style="color: #009900;">&#40;</span>mod3.lmer<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#obtain the variance-covariance matrix of the means</span>
vmat <span style="">&lt;-</span> cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>mod3.lmer<span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># modify the function for obtain difference-adjusted confidence intervals</span>
<span style="color: #666666; font-style: italic;"># change the t-functions to normal functions</span>
 ci.func2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>rowvals<span style="color: #339933;">,</span> lm.model<span style="color: #339933;">,</span> glm.vmat<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
nor.func1a <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>alpha<span style="color: #339933;">,</span> model<span style="color: #339933;">,</span> sig<span style="color: #009900;">&#41;</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pnorm"><span style="color: #003399; font-weight: bold;">pnorm</span></a><span style="color: #009900;">&#40;</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/qnorm"><span style="color: #003399; font-weight: bold;">qnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span>alpha<span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span> <span style="">*</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>sig<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="">/</span> <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> sig <span style="">%*%</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a> <span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="">-</span> <a href="http://inside-r.org/r-doc/stats/pnorm"><span style="color: #003399; font-weight: bold;">pnorm</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/qnorm"><span style="color: #003399; font-weight: bold;">qnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span>alpha<span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span> <span style="">*</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>sig<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="">/</span> <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> sig <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> lower.tail=F<span style="color: #009900;">&#41;</span>
nor.func2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>a<span style="color: #339933;">,</span>model<span style="color: #339933;">,</span>sigma<span style="color: #009900;">&#41;</span> nor.func1a<span style="color: #009900;">&#40;</span>a<span style="color: #339933;">,</span>model<span style="color: #339933;">,</span>sigma<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">.95</span>
n <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span>rowvals<span style="color: #009900;">&#41;</span>
xvec1b <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/numeric"><span style="color: #003399; font-weight: bold;">numeric</span></a><span style="color: #009900;">&#40;</span>n<span style="">*</span><span style="color: #009900;">&#40;</span>n<span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
vmat <span style="">&lt;-</span> glm.vmat<span style="color: #009900;">&#91;</span>rowvals<span style="color: #339933;">,</span>rowvals<span style="color: #009900;">&#93;</span>
ind <span style="">&lt;-</span> <span style="color: #cc66cc;">1</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>i <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #009900;">&#40;</span>n<span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>j <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #009900;">&#40;</span>i<span style="">+</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="">:</span>n<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
sig <span style="">&lt;-</span> vmat<span style="color: #009900;">&#91;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#solve for alpha</span>
xvec1b<span style="color: #009900;">&#91;</span>ind<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/uniroot"><span style="color: #003399; font-weight: bold;">uniroot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> nor.func2<span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> lm.model<span style="color: #339933;">,</span> sig<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.001</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.999</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">$</span>root
ind <span style="">&lt;-</span> ind<span style="">+</span><span style="color: #cc66cc;">1</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#125;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span>xvec1b
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># the variance-covariance matrix from lme4 has an unusual class</span>
<a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399; font-weight: bold;">class</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># we need to change the class to type matrix</span>
<a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399; font-weight: bold;">class</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.matrix"><span style="color: #003399; font-weight: bold;">as.matrix</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
ci.func2<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> mod3.lmer<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/as.matrix"><span style="color: #003399; font-weight: bold;">as.matrix</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># we get slightly diferent confidence levels depending on value of func and p</span>
vmat2 <span style="">&lt;-</span> cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>mod3.lmer<span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
ci.func2<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> mod3.lmer<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/as.matrix"><span style="color: #003399; font-weight: bold;">as.matrix</span></a><span style="color: #009900;">&#40;</span>vmat2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
vmat2 <span style="">&lt;-</span> cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>mod3.lmer<span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>cmat3<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
ci.func2<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>mod3.lmer<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/as.matrix"><span style="color: #003399; font-weight: bold;">as.matrix</span></a><span style="color: #009900;">&#40;</span>vmat2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># function to obtain means, std errs, 95% CIs, and difference-adjusted CIs</span>
make.data <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>func<span style="color: #339933;">,</span>p<span style="color: #339933;">,</span>model<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
  vmat <span style="">&lt;-</span> cmat3<span style="color: #009900;">&#40;</span>func<span style="color: #339933;">,</span>p<span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>model<span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>cmat3<span style="color: #009900;">&#40;</span>func<span style="color: #339933;">,</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  vals1 <span style="">&lt;-</span> ci.func2<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> model<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/as.matrix"><span style="color: #003399; font-weight: bold;">as.matrix</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  part1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'EA'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'NP'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'EA'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'NP'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> n=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> 
est=<a href="http://inside-r.org/r-doc/base/as.vector"><span style="color: #003399; font-weight: bold;">as.vector</span></a><span style="color: #009900;">&#40;</span>cmat3<span style="color: #009900;">&#40;</span>func<span style="color: #339933;">,</span>p<span style="color: #009900;">&#41;</span><span style="">%*%</span><a href="http://inside-r.org/r-doc/nlme/fixef"><span style="color: #003399; font-weight: bold;">fixef</span></a><span style="color: #009900;">&#40;</span>model<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> se=<a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
  part1<span style="">$</span>low95 <span style="">&lt;-</span> part1<span style="">$</span>est<span style="">+</span><a href="http://inside-r.org/r-doc/stats/qnorm"><span style="color: #003399; font-weight: bold;">qnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #009900;">&#41;</span><span style="">*</span>part1<span style="">$</span>se
part1<span style="">$</span>up95 <span style="">&lt;-</span> part1<span style="">$</span>est<span style="">+</span><a href="http://inside-r.org/r-doc/stats/qnorm"><span style="color: #003399; font-weight: bold;">qnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.975</span><span style="color: #009900;">&#41;</span><span style="">*</span>part1<span style="">$</span>se
part1<span style="">$</span>low85 <span style="">&lt;-</span> part1<span style="">$</span>est<span style="">+</span><a href="http://inside-r.org/r-doc/stats/qnorm"><span style="color: #003399; font-weight: bold;">qnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>vals1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="">*</span>part1<span style="">$</span>se
part1<span style="">$</span>up85 <span style="">&lt;-</span> part1<span style="">$</span>est<span style="">+</span><a href="http://inside-r.org/r-doc/stats/qnorm"><span style="color: #003399; font-weight: bold;">qnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>vals1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="">*</span>part1<span style="">$</span>se
part1<span style="">$</span>func <span style="">&lt;-</span> func
part1<span style="">$</span>p <span style="">&lt;-</span> p
part1
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># use function for different values of func and p</span>
part0a <span style="">&lt;-</span> make.data<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span>mod3.lmer<span style="color: #009900;">&#41;</span>
part0b <span style="">&lt;-</span> make.data<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'inoc'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>mod3.lmer<span style="color: #009900;">&#41;</span>
part0c <span style="">&lt;-</span> make.data<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span>mod3.lmer<span style="color: #009900;">&#41;</span>
part0d <span style="">&lt;-</span> make.data<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'mock'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>mod3.lmer<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># assemble results in single matrix</span>
fac.vals <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399; font-weight: bold;">rbind</span></a><span style="color: #009900;">&#40;</span>part0a<span style="color: #339933;">,</span>part0b<span style="color: #339933;">,</span>part0c<span style="color: #339933;">,</span>part0d<span style="color: #009900;">&#41;</span>
fac.vals
&nbsp;
<span style="color: #666666; font-style: italic;"># there is no function for getting confidence intervals for lme4 objects</span>
<span style="color: #666666; font-style: italic;"># we can obtain confidence intervals for an lme object with the intervals function</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/nlme/nlme"><span style="color: #003399; font-weight: bold;">nlme</span></a><span style="color: #009900;">&#41;</span>
mod3.lme <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/nlme/lme"><span style="color: #003399; font-weight: bold;">lme</span></a><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">*</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>func<span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/random"><span style="">random</span></a>=<span style="">~</span><span style="color: #cc66cc;">1</span><span style="">|</span>block<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># confint does not work on lme objects</span>
<a href="http://inside-r.org/r-doc/stats/confint"><span style="color: #003399; font-weight: bold;">confint</span></a><span style="color: #009900;">&#40;</span>mod3.lme<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/utils/methods"><span style="color: #003399; font-weight: bold;">methods</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/confint"><span style="color: #003399; font-weight: bold;">confint</span></a><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># intervals works</span>
<a href="http://inside-r.org/r-doc/nlme/intervals"><span style="color: #003399; font-weight: bold;">intervals</span></a><span style="color: #009900;">&#40;</span>mod3.lme<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># if we had a simpler model we could use intervals to obtain confidence intervals for mean</span>
<span style="color: #666666; font-style: italic;"># effects version of 2-factor interaction model</span>
mod3.lme <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/nlme/lme"><span style="color: #003399; font-weight: bold;">lme</span></a><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">*</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/packages/cran/random"><span style="">random</span></a>=<span style="">~</span><span style="color: #cc66cc;">1</span><span style="">|</span>block<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># means version of 2-factor interaction model</span>
mod3a.lme <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/nlme/lme"><span style="color: #003399; font-weight: bold;">lme</span></a><span style="color: #009900;">&#40;</span>pN<span style="">^</span><span style="color: #cc66cc;">2</span> <span style="">~</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/datasets/lh"><span style="color: #003399; font-weight: bold;">lh</span></a><span style="color: #009900;">&#41;</span><span style="">:</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><a href="http://inside-r.org/packages/cran/random"><span style="">random</span></a>=<span style="">~</span><span style="color: #cc66cc;">1</span><span style="">|</span>block<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=nitro<span style="color: #009900;">&#91;</span>nitro<span style="">$</span>tag<span style="">!</span>=<span style="color: #cc66cc;">444</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># obtain means</span>
<a href="http://inside-r.org/r-doc/nlme/fixef"><span style="color: #003399; font-weight: bold;">fixef</span></a><span style="color: #009900;">&#40;</span>mod3a.lme<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># obtain confidence intervals</span>
<a href="http://inside-r.org/r-doc/nlme/intervals"><span style="color: #003399; font-weight: bold;">intervals</span></a><span style="color: #009900;">&#40;</span>mod3a.lme<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># obtain variance covariance matrix of means</span>
<a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>mod3a.lme<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># group panel function</span>
my.panel <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">,</span> subscripts<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a><span style="color: #339933;">,</span> pch<span style="color: #339933;">,</span> group.number<span style="color: #339933;">,</span> ...<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
  <span style="color: #666666; font-style: italic;">#subset variables for the current panel</span>
  low95 <span style="">&lt;-</span> fac.vals<span style="">$</span>low95<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span>
  up95 <span style="">&lt;-</span> fac.vals<span style="">$</span>up95<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span>
  low85 <span style="">&lt;-</span> fac.vals<span style="">$</span>low85<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span>
  up85 <span style="">&lt;-</span> fac.vals<span style="">$</span>up85<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span>
  myjitter <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="">-</span><span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span>
  col2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'tomato'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'grey60'</span><span style="color: #009900;">&#41;</span>
  <span style="color: #666666; font-style: italic;">#95% confidence interval</span>
  <a href="http://inside-r.org/r-doc/lattice/panel.arrows"><span style="color: #003399; font-weight: bold;">panel.arrows</span></a><span style="color: #009900;">&#40;</span>x<span style="">+</span>myjitter<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>low95<span style="color: #339933;">,</span>x<span style="">+</span>myjitter<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>up95<span style="color: #339933;">,</span>angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span>
     code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a><span style="color: #009900;">&#41;</span>
  <span style="color: #666666; font-style: italic;">#50% confidence interval</span>
  <a href="http://inside-r.org/r-doc/lattice/panel.segments"><span style="color: #003399; font-weight: bold;">panel.segments</span></a><span style="color: #009900;">&#40;</span>x<span style="">+</span>myjitter<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>low85<span style="color: #339933;">,</span>x<span style="">+</span>myjitter<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>up85<span style="color: #339933;">,</span>
     <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=col2<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> lineend=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span>
  <a href="http://inside-r.org/r-doc/lattice/panel.lines"><span style="color: #003399; font-weight: bold;">panel.lines</span></a><span style="color: #009900;">&#40;</span>x<span style="">+</span>myjitter<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>y<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a><span style="color: #009900;">&#41;</span>
  <a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="">+</span>myjitter<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>y<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #009900;">&#41;</span>
  <a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="">+</span>myjitter<span style="color: #009900;">&#91;</span>group.number<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>y<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a><span style="color: #339933;">,</span> pch=pch<span style="color: #339933;">,</span> ...<span style="color: #009900;">&#41;</span>
  <a href="http://inside-r.org/r-doc/lattice/panel.abline"><span style="color: #003399; font-weight: bold;">panel.abline</span></a><span style="color: #009900;">&#40;</span>h=<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">26</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'lightgrey'</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># prepanel function to set limits for panels</span>
prepanel.ci2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #339933;">,</span>ly<span style="color: #339933;">,</span>uy<span style="color: #339933;">,</span>subscripts<span style="color: #339933;">,</span>...<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>ylim=<a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #339933;">,</span> uy<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> ly<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> finite=T<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span>
&nbsp;
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lattice"><span style="">lattice</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># two-factor interaction plot using lattice and group panel function</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>est<span style="">~</span>lh<span style="">|</span>func<span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #339933;">,</span> level=<span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/paste"><span style="color: #003399; font-weight: bold;">paste</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'P = '</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> sep=<span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
xlab =<span style="color: #0000ff;">'lh'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'Estimated mean'</span><span style="color: #339933;">,</span> groups=<a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=fac.vals<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">16</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> prepanel=prepanel.ci2<span style="color: #339933;">,</span> ly=fac.vals<span style="">$</span>low95<span style="color: #339933;">,</span> uy=fac.vals<span style="">$</span>up95<span style="color: #339933;">,</span> 
<a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399; font-weight: bold;">layout</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> panel.groups=my.panel<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<span style="color: #0000ff;">&quot;panel.superpose&quot;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># add a key to the graph</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>est<span style="">~</span>lh<span style="">|</span>func<span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #339933;">,</span> level=<span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/paste"><span style="color: #003399; font-weight: bold;">paste</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'P = '</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> sep=<span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
xlab =<span style="color: #0000ff;">'lh'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'Estimated mean'</span><span style="color: #339933;">,</span> groups=<a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=fac.vals<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">16</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> prepanel=prepanel.ci2<span style="color: #339933;">,</span> ly=fac.vals<span style="">$</span>low95<span style="color: #339933;">,</span> uy=fac.vals<span style="">$</span>up95<span style="color: #339933;">,</span> 
<a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399; font-weight: bold;">layout</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> panel.groups=my.panel<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<span style="color: #0000ff;">&quot;panel.superpose&quot;</span><span style="color: #339933;">,</span>
key=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>x=<span style="color: #cc66cc;">.85</span><span style="color: #339933;">,</span>y=<span style="color: #cc66cc;">.80</span><span style="color: #339933;">,</span> corner=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a>=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
<a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399; font-weight: bold;">text</span></a>=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'n = 1'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'n = 0'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># assign the graph to an object</span>
mygraph <span style="">&lt;-</span> 
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>est<span style="">~</span>lh<span style="">|</span>func<span style="">+</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #339933;">,</span> level=<span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/paste"><span style="color: #003399; font-weight: bold;">paste</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'P = '</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> sep=<span style="color: #0000ff;">''</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
xlab =<span style="color: #0000ff;">'lh'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'Estimated mean'</span><span style="color: #339933;">,</span> groups=<a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>n<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=fac.vals<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">16</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> prepanel=prepanel.ci2<span style="color: #339933;">,</span> ly=fac.vals<span style="">$</span>low95<span style="color: #339933;">,</span> uy=fac.vals<span style="">$</span>up95<span style="color: #339933;">,</span> 
<a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399; font-weight: bold;">layout</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> panel.groups=my.panel<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<span style="color: #0000ff;">&quot;panel.superpose&quot;</span><span style="color: #339933;">,</span>
key=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>x=<span style="color: #cc66cc;">.85</span><span style="color: #339933;">,</span>y=<span style="color: #cc66cc;">.88</span><span style="color: #339933;">,</span> corner=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a>=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>
<a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399; font-weight: bold;">text</span></a>=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'n = 1'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'n = 0'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># load the latticeExtra package and redo graph</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/latticeExtra"><span style="">latticeExtra</span></a><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># put strips on left and on top</span>
<span style="color: #003399; font-weight: bold;">useOuterStrips</span><span style="color: #009900;">&#40;</span>mygraph<span style="color: #009900;">&#41;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
