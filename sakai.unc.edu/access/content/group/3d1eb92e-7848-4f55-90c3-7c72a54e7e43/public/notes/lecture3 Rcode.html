<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 3</title>
</head>

<body>

<h2 align="center">R Code for Lecture 3 (Wednesday, August 29, 2012)</h2>
<div style="overflow:auto;">
  <div class="geshifilter">
    <pre class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#analysis from last time</span>
tadpoles <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.table"><span style="color: #003399; font-weight: bold;">read.table</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;ecol 563/tadpoles.csv&quot;</span><span style="color: #339933;">,</span> header=T<span style="color: #339933;">,</span> sep=<span style="color: #0000ff;">','</span><span style="color: #009900;">&#41;</span>
tadpoles<span style="">$</span>fac3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac3<span style="color: #009900;">&#41;</span>
out1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1 <span style="">+</span> fac2 <span style="">+</span> fac3 <span style="">+</span> fac1<span style="">:</span>fac2 <span style="">+</span> fac1<span style="">:</span>fac3 <span style="">+</span> fac2<span style="">:</span>fac3 <span style="">+</span> fac1<span style="">:</span>fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out1<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/car"><span style="">car</span></a><span style="color: #009900;">&#41;</span>
Anova<span style="color: #009900;">&#40;</span>out1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># list levels of a factor</span>
<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#create an experiment where the treatments are balanced</span>
<a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">&#40;</span>fac1=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac1<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span>fac2=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac2<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> fac3=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac3<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
junk &lt;- <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">&#40;</span>fac1=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac1<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span>fac2=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac2<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span>fac3=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac3<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
junk2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>fac1=<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span>junk<span style="">$</span>fac1<span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> fac2=<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span>junk<span style="">$</span>fac2<span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> fac3=<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span>junk<span style="">$</span>fac3<span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> y=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">120</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
junk2<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#fit model to balanced data</span>
mj <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>y<span style="">~</span>fac1<span style="">*</span>fac2<span style="">*</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=junk2<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#Type I and Type II tests are the same</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>mj<span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">Anova</span><span style="color: #009900;">&#40;</span>mj<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#data are unbalanced even with missing response values</span>
<a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>treatment<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#get treatment counts after removing observations with missing response values</span>
<a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>treatment<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac1<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac2<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac3<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># we dropped a 3-factor interaction and a 2-factor interaction</span>
Anova<span style="color: #009900;">&#40;</span>out1<span style="color: #009900;">&#41;</span>
out2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1 <span style="">+</span> fac2 <span style="">+</span> fac3 <span style="">+</span> fac1<span style="">:</span>fac2  <span style="">+</span> fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span><span style="color: #003399; font-weight: bold;">
Anova</span><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#variance heterogeneity</span>
<a href="http://inside-r.org/r-doc/graphics/boxplot"><span style="color: #003399; font-weight: bold;">boxplot</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>treatment<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #339933;">,</span> horizontal=T<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Mitotic activity'</span><span style="color: #339933;">,</span> las=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> 
treat.mean <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/tapply"><span style="color: #003399; font-weight: bold;">tapply</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #339933;">,</span> tadpoles<span style="">$</span>treatment<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #339933;">,</span> na.rm=T<span style="color: #009900;">&#41;</span>
treat.mean
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>treat.mean<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">8</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#calculate variances for each treatment</span>
treat.var <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/tapply"><span style="color: #003399; font-weight: bold;">tapply</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #339933;">,</span> tadpoles<span style="">$</span>treatment<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/var"><span style="color: #003399; font-weight: bold;">var</span></a><span style="color: #339933;">,</span> na.rm=T<span style="color: #009900;">&#41;</span>
treat.var
&nbsp;
<span style="color: #666666; font-style: italic;">#display variances in dot plot</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lattice"><span style="">lattice</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/dotplot"><span style="color: #003399; font-weight: bold;">dotplot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>treat.var<span style="color: #009900;">&#41;</span><span style="">~</span>treat.var<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Variance'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#residuals look heavy-tailed relative to a normal dist</span>
<span style="color: #003399; font-weight: bold;">qqPlot</span><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/residuals"><span style="color: #003399; font-weight: bold;">residuals</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#tests for variance homogeneity</span>
<a href="http://inside-r.org/r-doc/stats/bartlett.test"><span style="color: #003399; font-weight: bold;">bartlett.test</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="">~</span>tadpoles<span style="">$</span>treatment<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/fligner.test"><span style="color: #003399; font-weight: bold;">fligner.test</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="">~</span>tadpoles<span style="">$</span>treatment<span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">leveneTest</span><span style="color: #009900;">&#40;</span>response<span style="">~</span>treatment<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">leveneTest</span><span style="color: #009900;">&#40;</span>response<span style="">~</span>treatment<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #339933;">,</span> center=<a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#use weighted least squares</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/nlme/nlme"><span style="color: #003399; font-weight: bold;">nlme</span></a><span style="color: #009900;">&#41;</span>
out.g <- <a href="http://inside-r.org/r-doc/nlme/gls"><span style="color: #003399; font-weight: bold;">gls</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1<span style="">+</span>fac2<span style="">+</span>fac3<span style="">+</span>fac1<span style="">:</span>fac2<span style="">+</span>fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/na.action"><span style="color: #003399; font-weight: bold;">na.action</span></a>=<a href="http://inside-r.org/r-doc/stats/na.omit"><span style="color: #003399; font-weight: bold;">na.omit</span></a><span style="color: #339933;">,</span> method=<span style="color: #0000ff;">'ML'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.g<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out.g<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#let each treatment have its own variance</span>
out.g1 <- <a href="http://inside-r.org/r-doc/nlme/gls"><span style="color: #003399; font-weight: bold;">gls</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1<span style="">+</span>fac2<span style="">+</span>fac3<span style="">+</span>fac1<span style="">:</span>fac2<span style="">+</span>fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/na.action"><span style="color: #003399; font-weight: bold;">na.action</span></a>=<a href="http://inside-r.org/r-doc/stats/na.omit"><span style="color: #003399; font-weight: bold;">na.omit</span></a><span style="color: #339933;">,</span> method=<span style="color: #0000ff;">'ML'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/weights"><span style="color: #003399; font-weight: bold;">weights</span></a>=<a href="http://inside-r.org/r-doc/nlme/varIdent"><span style="color: #003399; font-weight: bold;">varIdent</span></a><span style="color: #009900;">&#40;</span>form=<span style="">~</span><span style="color: #cc66cc;">1</span><span style="">|</span>treatment<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style=""></span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out.g1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#Anova doesn't work on gls object </span><span style="color: #003399; font-weight: bold;">
Anova</span><span style="color: #009900;">&#40;</span>out.g1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#anova has a special method for gls objects: type argument</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out.g1<span style="color: #339933;">, </span>type=<span style="color: #0000ff;">'sequential'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out.g1<span style="color: #339933;">, </span>type=<span style="color: #0000ff;">'marginal'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.g1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#estimates have not changed much</span>
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.g1<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.g<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#compare residuals</span>
<span style="color: #003399; font-weight: bold;">qqPlot</span><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/residuals"><span style="color: #003399; font-weight: bold;">residuals</span></a><span style="color: #009900;">&#40;</span>out.g<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #003399; font-weight: bold;">qqPlot</span><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/residuals"><span style="color: #003399; font-weight: bold;">residuals</span></a><span style="color: #009900;">&#40;</span>out.g1<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'normalized'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#simulate from final model</span>
<a href="http://inside-r.org/r-doc/stats/simulate"><span style="color: #003399; font-weight: bold;">simulate</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span>n=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#six simulated data sets</span>
junk <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/simulate"><span style="color: #003399; font-weight: bold;">simulate</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span>n=<span style="color: #cc66cc;">6</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#generates a data frame</span>
<a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399; font-weight: bold;">class</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#observations with missing values for response area excluded</span>
<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#using the rep function</span>
<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#repeat the number of simulated values</span>
<a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/nrow"><span style="color: #003399; font-weight: bold;">nrow</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#41;</span>
my.dat1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>sims=<a href="http://inside-r.org/r-doc/base/unlist"><span style="color: #003399; font-weight: bold;">unlist</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>simnum = <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/nrow"><span style="color: #003399; font-weight: bold;">nrow</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
my.dat1<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># display kernel density estimates of distribution of simulated data</span>
<a href="http://inside-r.org/r-doc/lattice/densityplot"><span style="color: #003399; font-weight: bold;">densityplot</span></a><span style="color: #009900;">&#40;</span><span style="">~</span>sims<span style="">|</span>simnum<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=my.dat1<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/densityplot"><span style="color: #003399; font-weight: bold;">densityplot</span></a><span style="color: #009900;">&#40;</span><span style="">~</span>sims<span style="">|</span>factor<span style="color: #009900;">&#40;</span>simnum<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=my.dat1<span style="color: #339933;">,</span> plot.points=F<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># add kernel density of the raw data</span>
<a href="http://inside-r.org/r-doc/lattice/densityplot"><span style="color: #003399; font-weight: bold;">densityplot</span></a><span style="color: #009900;">&#40;</span><span style="">~</span>sims<span style="">|</span>factor<span style="color: #009900;">&#40;</span>simnum<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=my.dat1<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a href="http://inside-r.org/r-doc/lattice/panel.densityplot"><span style="color: #003399; font-weight: bold;">panel.densityplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> plot.points=F<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/panel.densityplot"><span style="color: #003399; font-weight: bold;">panel.densityplot</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> plot.points=F<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># remove missing response observations from treatment and response variable</span>
<span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span>
short.treatment<span style=""> &lt;-</span> tadpoles<span style="">$</span>treatment<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span>
short.response<span style=""> &lt;-</span> tadpoles<span style="">$</span>response<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#calculate maximum response in CoD1 treatment</span>
short.response<span style="color: #009900;">&#91;</span>short.treatment<span style="">==</span><span style="color: #0000ff;">'CoD1'</span><span style="color: #009900;">&#93;</span>
CoD1.max <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>short.response<span style="color: #009900;">&#91;</span>short.treatment<span style="">==</span><span style="color: #0000ff;">'CoD1'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
CoD1.max
&nbsp;
<span style="color: #666666; font-style: italic;">#obtain 1000 simulated data sets</span>
junk<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/stats/simulate"><span style="color: #003399; font-weight: bold;">simulate</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span>n=<span style="color: #cc66cc;">1000</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/colnames"><span style="color: #003399; font-weight: bold;">colnames</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#we can access the elements using $, [,], or [[]] notation</span>
junk<span style="">$</span>sim_1
junk<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span>
junk<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#maximum response for coD1 treatment in simulation 1</span>
<a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span>short.treatment<span style="">==</span><span style="color: #0000ff;">'CoD1'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#obtain maximum for CoD1 treatment in each simulation</span>
sim.max <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>junk<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#91;</span>short.treatment<span style="">==</span><span style="color: #0000ff;">'CoD1'</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#the maximum simulated maxium is less than the actual maxiumum</span>
<a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>sim.max<span style="color: #009900;">&#41;</span>
CoD1.max
&nbsp;
<span style="color: #666666; font-style: italic;">#graph the density</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/density"><span style="color: #003399; font-weight: bold;">density</span></a><span style="color: #009900;">&#40;</span>sim.max<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#expand x-limits to make room for actual maximum</span>
<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>sim.max<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>sim.max<span style="color: #339933;">,</span>CoD1.max<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/density"><span style="color: #003399; font-weight: bold;">density</span></a><span style="color: #009900;">&#40;</span>sim.max<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> xlim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>sim.max<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>sim.max<span style="color: #339933;">,</span>CoD1.max<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#add actual maximum</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>CoD1.max<span style="color: #339933;">, </span><span style="color: #cc66cc;">0</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">8</span><span style="color: #009900;">&#41;</span></pre>
  </div>
</div>
<p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
