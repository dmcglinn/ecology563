<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 16</title>
</head>

<body>

<h2 align="center">R Code for Lecture 16 (Wednesday, October 17, 2012)</h2>
<div style="overflow:auto;">
  <div class="geshifilter">
  <pre class="r geshifilter-R" style="font-family:monospace;"><a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>mfrow=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>lend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="">?</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a>
&nbsp;
<span style="color: #666666; font-style: italic;"># Fix mu, vary theta</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">0.1<span style="color: #009900;">&#41;</span></span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">0.1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">0.1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">100</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># compare Poisson and NB</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>mfrow=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">100</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/paste"><span style="color: #003399; font-weight: bold;">paste</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'NB: '</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">100</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #339933;">,</span>lambda=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/paste"><span style="color: #003399; font-weight: bold;">paste</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Poisson: '</span><span style="color: #339933;">,</span>mu<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># fix theta, vary mu</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>mfrow=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">40</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">40</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">0.1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">.1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">40</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">40</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">0.1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">.1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">40</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">40</span><span style="color: #339933;">,</span>mu=<span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>size=<span style="color: #cc66cc;">0.1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span>lwd=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span>xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span>ylab=<span style="color: #0000ff;">'probability'</span><span style="color: #339933;">,</span>ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.8</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>mu<span style="">==</span><span style="color: #cc66cc;">20</span><span style="color: #339933;">,</span>theta<span style="">==</span><span style="color: #cc66cc;">.1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>mfrow=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">##### Aphid data set ######</span>
&nbsp;
num.stems <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># data frame of tabulated data</span>
aphids <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>aphids=<span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> counts=num.stems<span style="color: #009900;">&#41;</span>
aphid.data <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span>num.stems<span style="color: #009900;">&#41;</span>
poisson.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>lambda<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="color: #339933;">,</span> lambda<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
poisson.negloglik <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>lambda<span style="color: #009900;">&#41;</span> <span style="">-</span>poisson.LL<span style="color: #009900;">&#40;</span>lambda<span style="color: #009900;">&#41;</span>
out.pois <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>poisson.negloglik<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
exp.pois <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #cc66cc;">50</span>
out.bar <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #339933;">,</span> ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">11</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> names.arg=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'9+'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>out.bar<span style="color: #339933;">,</span> exp.pois<span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'o'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/legend"><span style="color: #003399; font-weight: bold;">legend</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'topright'</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Poisson model'</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #339933;">,</span> bty=<span style="color: #0000ff;">'n'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># version with two arguments</span>
NB.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>mu<span style="color: #339933;">,</span>theta<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="color: #339933;">,</span>mu=mu<span style="color: #339933;">,</span> size=theta<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
NB.LL<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># version with a vector argument</span>
NB.LL2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="color: #339933;">,</span>mu=p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">, </span>size=p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># need negative log-likelihood</span>
negNB.LL2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="">-</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="color: #339933;">,</span>mu=p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">, </span>size=p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.nb <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negNB.LL2<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.nb
&nbsp;
<span style="color: #666666; font-style: italic;"># predicted probabilities with tail category</span>
exp.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>mu=out.nb<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> size=out.nb<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/pnbinom"><span style="color: #003399; font-weight: bold;">pnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>mu=out.nb<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> size=out.nb<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>lower.tail=F<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
exp.p
<span style="color: #666666; font-style: italic;">#expected counts</span>
exp.nb <span style="">&lt;-</span> <span style="color: #cc66cc;">50</span><span style="">*</span>exp.p
&nbsp;
<span style="color: #666666; font-style: italic;">#add NB predictions to graph</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>out.bar<span style="color: #339933;">,</span> exp.nb<span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">15</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'o'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
&nbsp;
exp.nb
<span style="color: #666666; font-style: italic;"># collaps categories to pass the &gt;5 rule</span>
exp.nb.short <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>exp.nb<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>exp.nb<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="">:</span><span style="color: #cc66cc;">7</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>exp.nb<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">8</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
exp.nb.short
<span style="color: #666666; font-style: italic;"># group observed values the same way</span>
obs.short <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="">:</span><span style="color: #cc66cc;">7</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">8</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
obs.short
<span style="color: #666666; font-style: italic;"># Pearson statistic</span>
pearson <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>obs.short<span style="">-</span>exp.nb.short<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>exp.nb.short<span style="color: #009900;">&#41;</span>
pearson
<span style="color: #666666; font-style: italic;"># p-value</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span>pearson<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span>obs.short<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># parametric bootstrap</span>
<a href="http://inside-r.org/r-doc/stats/chisq.test"><span style="color: #003399; font-weight: bold;">chisq.test</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #339933;">,</span> p=exp.p<span style="color: #339933;">, </span>simulate.p.value=T<span style="color: #339933;">,</span> B=<span style="color: #cc66cc;">999</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># fit negative binomial using glm.nb</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/MASS"><span style="">MASS</span></a><span style="color: #009900;">&#41;</span> 
out.glmnb &lt;- <a href="http://inside-r.org/r-doc/MASS/glm.nb"><span style="color: #003399; font-weight: bold;">glm.nb</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style=""></span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.glmnb<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.glmnb<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># undo log link</span>
<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.glmnb<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>out.glmnb<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">### slugs data set ####</span>
&nbsp;
slugs <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.delim"><span style="color: #003399; font-weight: bold;">read.delim</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'ecol 563/slugsurvey.txt'</span><span style="color: #009900;">&#41;</span>
slugs<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
slug.table <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span>
slug.table
&nbsp;
<span style="color: #666666; font-style: italic;"># bar plots of counts</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#stacked bar</span>
<a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>slug.table<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># separate distributions</span>
<a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>slug.table<span style="color: #339933;">,</span> beside=T<span style="color: #009900;">&#41;</span>
coord1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>slug.table<span style="color: #339933;">,</span> beside=T<span style="color: #009900;">&#41;</span><span style="">-&gt;</span>coord1
coord1
<span style="color: #666666; font-style: italic;"># add labels to bars</span>
coord1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>slug.table<span style="color: #339933;">,</span> beside=T<span style="color: #339933;">,</span> names.arg=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> cex.names=<span style="color: #cc66cc;">0.75</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add labels for groups</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">2.5</span><span style="color: #339933;">,</span> at=coord1<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399; font-weight: bold;">text</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Nursery'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># interweaved bars</span>
<a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>slug.table<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> beside=T<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/legend"><span style="color: #003399; font-weight: bold;">legend</span></a>=T<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># lattice plot</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lattice"><span style="">lattice</span></a><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># make a data frame out of table</span>
slugtable <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>slug.table<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># count categories are a factor variable</span>
slugtable<span style="">$</span>Var1
&nbsp;
<span style="color: #666666; font-style: italic;"># panels of bar plots</span>
<a href="http://inside-r.org/r-doc/lattice/barchart"><span style="color: #003399; font-weight: bold;">barchart</span></a><span style="color: #009900;">&#40;</span>Freq<span style="">~</span>Var1<span style="">|</span>Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugtable<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/barchart"><span style="color: #003399; font-weight: bold;">barchart</span></a><span style="color: #009900;">&#40;</span>Freq<span style="">~</span>Var1<span style="">|</span>Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugtable<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey70'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>Freq<span style="">~</span>Var1<span style="">|</span>Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugtable<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey70'</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">6</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>Freq<span style="">~</span>Var1<span style="">|</span>Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugtable<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey70'</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> lineend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Single Poisson mean model</span>
negpoisLL<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span>lambda=p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL<span style="color: #009900;">&#125;</span>
<a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #009900;">&#41;</span>
negpoisLL<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
negpoisLL<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1.775</span><span style="color: #009900;">&#41;</span>
out.pois1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negpoisLL<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
out.pois1
out.pois1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negpoisLL<span style="color: #339933;">,</span><span style="color: #cc66cc;">1.8</span><span style="color: #009900;">&#41;</span><span style="">-&gt;</span>out.pois
&nbsp;
<span style="color: #666666; font-style: italic;"># separate mean Poisson model</span>
negpoisLL2<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> lambda=p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL<span style="color: #009900;">&#125;</span>
negpoisLL2<span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.pois2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negpoisLL2<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.pois2
&nbsp;
<span style="color: #666666; font-style: italic;"># likelihood ratio test that means are different</span>
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>out.pois1<span style="">$</span>minimum<span style="">-</span>out.pois2<span style="">$</span>minimum<span style="color: #009900;">&#41;</span>
LR <span style="">&lt;-</span> <span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>out.pois1<span style="">$</span>minimum<span style="">-</span>out.pois2<span style="">$</span>minimum<span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span>LR<span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># fit same models using glm</span>
out1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs <span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
out2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># likelihood ratio test comparing models</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out1<span style="color: #339933;">,</span> out2<span style="color: #339933;">,</span> test=<span style="color: #0000ff;">'Chisq'</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># sequential likelihood ratio tests</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span> test=<span style="color: #0000ff;">'Chisq'</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># Wald test</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># negative binomial version of the models</span>
out1.nb <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/MASS/glm.nb"><span style="color: #003399; font-weight: bold;">glm.nb</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #009900;">&#41;</span>
out2.nb <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/MASS/glm.nb"><span style="color: #003399; font-weight: bold;">glm.nb</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out1.nb<span style="color: #339933;">,</span> out2.nb<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2.nb<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain predicted means</span>
<a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">, </span>type=<span style="color: #0000ff;">'response'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># get means for each field type</span>
slugtable<span style="">$</span>mu <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'response'</span><span style="color: #339933;">,</span> newdata=<a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>field=slugtable<span style="">$</span>Var2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
slugtable
&nbsp;
<span style="color: #666666; font-style: italic;"># calcualte probabilities of each category</span>
slugtable<span style="">$</span>p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.character"><span style="color: #003399; font-weight: bold;">as.character</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> lambda=slugtable<span style="">$</span>mu<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># add tail probability to the last category</span>
slugtable<span style="">$</span>p2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.character"><span style="color: #003399; font-weight: bold;">as.character</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> lambda=slugtable<span style="">$</span>mu<span style="color: #009900;">&#41;</span><span style="">+</span>
<span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1<span style="">==</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span><span style="">*</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.character"><span style="color: #003399; font-weight: bold;">as.character</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> lambda=slugtable<span style="">$</span>mu<span style="color: #339933;">,</span> lower.tail=F<span style="color: #009900;">&#41;</span>
&nbsp;
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">11</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>p2<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">11</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain expected counts</span>
<a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span>
slugtable<span style="">$</span>exp <span style="">&lt;-</span> <span style="color: #cc66cc;">40</span><span style="">*</span>slugtable<span style="">$</span>p2
slugtable
&nbsp;
<span style="color: #666666; font-style: italic;"># add Poisson predictions to the graph</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>Freq<span style="">~</span>Var1<span style="">|</span>Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugtable<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'count category'</span><span style="color: #339933;">, </span><a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #339933;">,</span>subscripts<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">, </span>type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey70'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> lineend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/panel.points"><span style="color: #003399; font-weight: bold;">panel.points</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">, </span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span><span style="color: #339933;">, </span>pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">, </span>type=<span style="color: #0000ff;">'o'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
