<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 25</title>
</head>

<body>

<h2 align="center">R Code for Lecture 25 (Monday, November 19, 2012)</h2>
<div style="overflow:auto;"><div class="geshifilter">
<pre class="r geshifilter-R" style="font-family:monospace;">birds <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.csv"><span style="color: #003399; font-weight: bold;">read.csv</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'ecol 563/birds.csv'</span><span style="color: #009900;">&#41;</span>
birds.short <span style="">&lt;-</span> birds<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>birds<span style="">$</span>S<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;"># create variables for WinBUGS</span>
y <span style="">&lt;-</span> birds.short<span style="">$</span>S
year2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>year<span style="">==</span><span style="color: #cc66cc;">2006</span><span style="color: #009900;">&#41;</span>
year3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>year<span style="">==</span><span style="color: #cc66cc;">2007</span><span style="color: #009900;">&#41;</span>
n <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># number of patches</span>
J <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>patch<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># patch identifier renumbered</span>
patch <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>patch<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/setwd"><span style="color: #003399; font-weight: bold;">setwd</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;C:/Users/jmweiss/Documents/ecol 563/models&quot;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">##### BUGS model: model2.txt ####</span>
&nbsp;
model<span style="color: #009900;">&#123;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>i <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>n<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
y<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">&lt;-</span>a<span style="color: #009900;">&#91;</span>patch<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span> <span style="">+</span> b1<span style="">*</span>year2<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">+</span> b2<span style="">*</span>year3<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>
mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span>log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>j <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>J<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
a<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
b1<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
b2<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">###############</span>
&nbsp;
bird.data <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;y&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;year2&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;year3&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;n&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;J&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;patch&quot;</span><span style="color: #009900;">&#41;</span>
bird.inits <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>a=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span>J<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b1=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b2=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span>
bird.parms <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b1&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b2&quot;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># WinBUGS run</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/arm"><span style="">arm</span></a><span style="color: #009900;">&#41;</span>
mod1.bugs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">bugs</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span> bird.inits<span style="color: #339933;">,</span> bird.parms<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model2.txt&quot;</span><span style="color: #339933;">,</span> bugs.directory=<span style="color: #0000ff;">&quot;C:/WinBUGS14&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> 
n.iter=<span style="color: #cc66cc;">10000</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/debug"><span style="color: #003399; font-weight: bold;">debug</span></a>=T<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># JAGS run</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/R2jags"><span style="">R2jags</span></a><span style="color: #009900;">&#41;</span>
mod1.jags <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">jags</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span> bird.inits<span style="color: #339933;">,</span> bird.parms<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model2.txt&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> n.iter=<span style="color: #cc66cc;">1000</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>mod1.bugs<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># WinBUGS objects returned by JAGS</span>
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>mod1.jags<span style="">$</span>BUGSoutput<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># examine traces of Markov chains</span>
mod1.mcmc <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">as.mcmc.list</span><span style="color: #009900;">&#40;</span>mod1.bugs<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>mod1.mcmc<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399; font-weight: bold;">layout</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
mod1jags.mcmc <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">as.mcmc</span><span style="color: #009900;">&#40;</span>mod1.jags<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>mod1jags.mcmc<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/layout"><span style="color: #003399; font-weight: bold;">layout</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># random intercepts model--first parameterization</span>
&nbsp;
<span style="color: #666666; font-style: italic;">########### BUGS model: model3.txt ###########</span>
&nbsp;
model<span style="color: #009900;">&#123;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>i <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>n<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
y<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">&lt;-</span>a<span style="color: #009900;">&#91;</span>patch<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span> <span style="">+</span> b1<span style="">*</span>year2<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">+</span> b2<span style="">*</span>year3<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>
mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span>log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>j <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>J<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
a<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span>mu.a<span style="color: #339933;">,</span>tau.a<span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
b1<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
b2<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
mu.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
tau.a <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">pow</span><span style="color: #009900;">&#40;</span>sigma.a<span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
sigma.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dunif"><span style="color: #003399; font-weight: bold;">dunif</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10000</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#####################</span>
&nbsp;
&nbsp;
bird.inits <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>a=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span>J<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b1=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b2=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> mu.a=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> sigma.a=<a href="http://inside-r.org/r-doc/stats/runif"><span style="color: #003399; font-weight: bold;">runif</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span>
bird.parms <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b1&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b2&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;mu.a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;sigma.a&quot;</span><span style="color: #009900;">&#41;</span>
mod3.bugs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">bugs</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span> bird.inits<span style="color: #339933;">,</span> bird.parms<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model3.txt&quot;</span><span style="color: #339933;">,</span> bugs.directory=<span style="color: #0000ff;">&quot;C:/WinBUGS14&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> n.iter=<span style="color: #cc66cc;">50</span><span style="color: #009900;">&#41;</span>
mod3.bugs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">bugs</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span> bird.inits<span style="color: #339933;">,</span> bird.parms<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model3.txt&quot;</span><span style="color: #339933;">,</span> bugs.directory=<span style="color: #0000ff;">&quot;C:/WinBUGS14&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> n.iter=<span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/debug"><span style="color: #003399; font-weight: bold;">debug</span></a>=T<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>mod3.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;Rhat&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>mod3.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;n.eff&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
mod3.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">101</span><span style="">:</span><span style="color: #cc66cc;">106</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># random intercepts model--second parameterization</span>
&nbsp;
<span style="color: #666666; font-style: italic;">##### BUGS model: model3a.txt ######</span>
&nbsp;
model<span style="color: #009900;">&#123;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>i <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>n<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
y<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">&lt;-</span>a<span style="color: #009900;">&#91;</span>patch<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span> <span style="">+</span> b1<span style="">*</span>year2<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">+</span> b2<span style="">*</span>year3<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>
mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span>log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
<span style="color: #666666; font-style: italic;"># frequentist parallel--random intercept effects</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>j <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>J<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
u0<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span>tau.a<span style="color: #009900;">&#41;</span>
a<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> mu.a <span style="">+</span> u0<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span>
<span style="color: #009900;">&#125;</span>
b1<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
b2<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
mu.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
tau.a <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">pow</span><span style="color: #009900;">&#40;</span>sigma.a<span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
sigma.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dunif"><span style="color: #003399; font-weight: bold;">dunif</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1000</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">###############</span>
&nbsp;
&nbsp;
bird.inits <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>u0=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span>J<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b1=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b2=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> mu.a=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> sigma.a=<a href="http://inside-r.org/r-doc/stats/runif"><span style="color: #003399; font-weight: bold;">runif</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span>
bird.parms <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;u0&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b1&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b2&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;mu.a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;sigma.a&quot;</span><span style="color: #009900;">&#41;</span>
mod3a.bugs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">bugs</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span> bird.inits<span style="color: #339933;">,</span> bird.parms<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model3a.txt&quot;</span><span style="color: #339933;">,</span> bugs.directory=<span style="color: #0000ff;">&quot;C:/WinBUGS14&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> n.iter=<span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/debug"><span style="color: #003399; font-weight: bold;">debug</span></a>=T<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># frequentist version of the model</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lme4"><span style="">lme4</span></a><span style="color: #009900;">&#41;</span>
mod.lmer <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">lmer</span><span style="color: #009900;">&#40;</span>S<span style="">~</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>year<span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">|</span>patch<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=birds<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/nlme/fixef"><span style="color: #003399; font-weight: bold;">fixef</span></a><span style="color: #009900;">&#40;</span>mod.lmer<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># frequentist patch random effects</span>
<a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/nlme/ranef"><span style="color: #003399; font-weight: bold;">ranef</span></a><span style="color: #009900;">&#40;</span>mod.lmer<span style="color: #009900;">&#41;</span><span style="">$</span>patch<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># compare with Bayesian estimates</span>
<a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">&#40;</span>mod3a.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># frequentist random intercepts</span>
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>mod.lmer
&nbsp;
<span style="color: #666666; font-style: italic;">### add patch-level predictors: area and landscape ###</span>
<a href="http://inside-r.org/r-doc/base/unique"><span style="color: #003399; font-weight: bold;">unique</span></a><span style="color: #009900;">&#40;</span>birds<span style="">$</span>landscape<span style="color: #009900;">&#41;</span>
mod2.lmer <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">lmer</span><span style="color: #009900;">&#40;</span>S<span style="">~</span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>year<span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/MASS/area"><span style="color: #003399; font-weight: bold;">area</span></a><span style="color: #009900;">&#41;</span><span style="">+</span>landscape<span style="">+</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">|</span>patch<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=birds<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain one value per patch</span>
L.area <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/tapply"><span style="color: #003399; font-weight: bold;">tapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>area<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>birds.short<span style="">$</span>patch<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># L.area is an array, we need it to be a vector</span>
<a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399; font-weight: bold;">class</span></a><span style="color: #009900;">&#40;</span>L.area<span style="color: #009900;">&#41;</span>
L.area <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/tapply"><span style="color: #003399; font-weight: bold;">tapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>area<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span>birds.short<span style="">$</span>patch<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/class"><span style="color: #003399; font-weight: bold;">class</span></a><span style="color: #009900;">&#40;</span>L.area<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># there is a missing value due to a phantom factor level</span>
L.area
&nbsp;
<span style="color: #666666; font-style: italic;"># redeclare patch as a factor</span>
L.area <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/tapply"><span style="color: #003399; font-weight: bold;">tapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>area<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>patch<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># create landscape variable</span>
Lscape <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/tapply"><span style="color: #003399; font-weight: bold;">tapply</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>landscape<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>birds.short<span style="">$</span>patch<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># dummy variables for landscape</span>
Lscape2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>Lscape<span style="">==</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
Lscape3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>Lscape<span style="">==</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
Lscape4 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>Lscape<span style="">==</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#### BUGS program: model4.txt ###########</span>
&nbsp;
model<span style="color: #009900;">&#123;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>i <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>n<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
y<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">&lt;-</span>a<span style="color: #009900;">&#91;</span>patch<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span> <span style="">+</span> b1<span style="">*</span>year2<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">+</span> b2<span style="">*</span>year3<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>
mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span>log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>j <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>J<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
a<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span>a.hat<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>tau.a<span style="color: #009900;">&#41;</span>
a.hat<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> mu.a <span style="">+</span> g1<span style="">*</span>L.area<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">+</span> g2<span style="">*</span>Lscape2<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">+</span> g3<span style="">*</span>Lscape3<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">+</span> g4<span style="">*</span>Lscape4<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span>
<span style="color: #009900;">&#125;</span>
g1<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
g2<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
g3<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
g4<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
b1<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
b2<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
mu.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
tau.a <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">pow</span><span style="color: #009900;">&#40;</span>sigma.a<span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
sigma.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dunif"><span style="color: #003399; font-weight: bold;">dunif</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10000</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">####################</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># change data, inits, and parm objects</span>
bird.data <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;y&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;year2&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;year3&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;n&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;J&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;patch&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;L.area&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Lscape2&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Lscape3&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;Lscape4&quot;</span><span style="color: #009900;">&#41;</span>
bird.inits <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>a=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span>J<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b1=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b2=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> mu.a=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> sigma.a=<a href="http://inside-r.org/r-doc/stats/runif"><span style="color: #003399; font-weight: bold;">runif</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> g1=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> g2=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> g3=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> g4=<a href="http://inside-r.org/r-doc/stats/rnorm"><span style="color: #003399; font-weight: bold;">rnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span>
bird.parms <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b1&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b2&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;mu.a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;sigma.a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;g1&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;g2&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;g3&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;g4&quot;</span><span style="color: #009900;">&#41;</span>
&nbsp;
mod3a.bugs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">bugs</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span> bird.inits<span style="color: #339933;">,</span> bird.parms<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model4.txt&quot;</span><span style="color: #339933;">,</span> bugs.directory=<span style="color: #0000ff;">&quot;C:/WinBUGS14&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> n.iter=<span style="color: #cc66cc;">100</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/debug"><span style="color: #003399; font-weight: bold;">debug</span></a>=T<span style="color: #009900;">&#41;</span>
mod3a.bugs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">bugs</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span> bird.inits<span style="color: #339933;">,</span> bird.parms<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model4.txt&quot;</span><span style="color: #339933;">,</span> bugs.directory=<span style="color: #0000ff;">&quot;C:/WinBUGS14&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> n.iter=<span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/debug"><span style="color: #003399; font-weight: bold;">debug</span></a>=T<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>mod3a.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;Rhat&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>mod3a.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;n.eff&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
mod3a.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">100</span><span style="">:</span><span style="color: #cc66cc;">110</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#compare to frequentist estimates</span>
<a href="http://inside-r.org/r-doc/nlme/fixef"><span style="color: #003399; font-weight: bold;">fixef</span></a><span style="color: #009900;">&#40;</span>mod2.lmer<span style="color: #009900;">&#41;</span>
mod3a.bugs<span style="">$</span>summary<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">102</span><span style="">:</span><span style="color: #cc66cc;">110</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># calculate mean richness by landscape for 2005 and patches of area = 1</span>
&nbsp;
<span style="color: #666666; font-style: italic;">##### alter BUGS program to calculate means: model4.txt #####</span>
&nbsp;
model<span style="color: #009900;">&#123;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>i <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>n<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
y<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="">&lt;-</span>a<span style="color: #009900;">&#91;</span>patch<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span> <span style="">+</span> b1<span style="">*</span>year2<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">+</span> b2<span style="">*</span>year3<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span>
mu.hat<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span>log.mu<span style="color: #009900;">&#91;</span>i<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>j <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span>J<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
a<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span><span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span>a.hat<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>tau.a<span style="color: #009900;">&#41;</span>
a.hat<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> mu.a <span style="">+</span> g1<span style="">*</span>L.area<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">+</span> g2<span style="">*</span>Lscape2<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">+</span> g3<span style="">*</span>Lscape3<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span> <span style="">+</span> g4<span style="">*</span>Lscape4<span style="color: #009900;">&#91;</span>j<span style="color: #009900;">&#93;</span>
<span style="color: #009900;">&#125;</span>
g1<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
g2<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
g3<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
g4<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
b1<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
b2<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
mu.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dnorm"><span style="color: #003399; font-weight: bold;">dnorm</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.000001</span><span style="color: #009900;">&#41;</span>
tau.a <span style="">&lt;-</span><span style="color: #003399; font-weight: bold;"> pow</span><span style="color: #009900;">&#40;</span>sigma.a<span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
sigma.a<span style="">~</span><a href="http://inside-r.org/r-doc/stats/dunif"><span style="color: #003399; font-weight: bold;">dunif</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10000</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># landscape means in 2005 when area=1</span>
mean1 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">exp</span>(mu.a)
mean2 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">exp</span>(mu.a<span style="">+</span>g2)
mean3 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">exp</span>(mu.a<span style="">+</span>g3)
mean4 <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">exp</span>(mu.a<span style="">+</span>g4)
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">####################</span>
&nbsp;
bird.parms2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b1&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;b2&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;mu.a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;sigma.a&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;g1&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;g2&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;g3&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;g4&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;mean1&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean2&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean3&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean4&quot;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># rerun model using last values of previous run </span>
mod4.bugs <span style="">&lt;-</span> <span style="color: #003399; font-weight: bold;">bugs</span><span style="color: #009900;">&#40;</span>bird.data<span style="color: #339933;">,</span>mod3a.bugs<span style="">$</span>last.values <span style="color: #339933;">,</span> bird.parms2<span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;model4.txt&quot;</span><span style="color: #339933;">,</span> bugs.directory=<span style="color: #0000ff;">&quot;C:/WinBUGS14&quot;</span><span style="color: #339933;">,</span> n.chains=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> n.iter=<span style="color: #cc66cc;">1000</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/debug"><span style="color: #003399; font-weight: bold;">debug</span></a>=T<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># percentile credible intervals</span>
<a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>mod4.bugs<span style="">$</span>sims.matrix<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;mean1&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean2&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean3&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean4&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/stats/quantile"><span style="color: #003399; font-weight: bold;">quantile</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.975</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># HPD credible intervals</span>
<span style="color: #003399; font-weight: bold;">HPDinterval</span><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">as.mcmc</span><span style="color: #009900;">&#40;</span>mod4.bugs<span style="">$</span>sims.matrix<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;mean1&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean2&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean3&quot;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mean4&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># we can also just add the appropriate columns of sims.matrix</span>
<span style="color: #666666; font-style: italic;"># and use quantile function on the result</span>
<a href="http://inside-r.org/r-doc/stats/quantile"><span style="color: #003399; font-weight: bold;">quantile</span></a><span style="color: #009900;">&#40;</span><span style="color: #003399; font-weight: bold;">exp</span><span style="color: #009900;">&#40;</span>mod4.bugs<span style="">$</span>sims.matrix<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;mu.a&quot;</span><span style="color: #009900;">&#93;</span><span style="">+</span>mod4.bugs<span style="">$</span>sims.matrix<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #0000ff;">&quot;g2&quot;</span><span style="color: #009900;">&#93;</span><span style="color: #339933;"><span style="color: #009900;">&#41;</span>,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.975</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
