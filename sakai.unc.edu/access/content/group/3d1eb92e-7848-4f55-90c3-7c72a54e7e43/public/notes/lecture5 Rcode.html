<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 5</title>
</head>

<body>

<h2 align="center">R Code for Lecture 5 (Monday, September 10, 2012)</h2>
<div style="overflow:auto;">
  <div class="geshifilter">
<pre class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#load data and fit models</span>
&nbsp;
tadpoles <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.table"><span style="color: #003399; font-weight: bold;">read.table</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;ecol 563/tadpoles.csv&quot;</span><span style="color: #339933;">,</span> header=T<span style="color: #339933;">,</span> sep=<span style="color: #0000ff;">','</span><span style="color: #009900;">&#41;</span>
tadpoles<span style="">$</span>fac3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac3<span style="color: #009900;">&#41;</span>
out1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1 <span style="">+</span> fac2 <span style="">+</span> fac3 <span style="">+</span> fac1<span style="">:</span>fac2 <span style="">+</span> fac1<span style="">:</span>fac3 <span style="">+</span> fac2<span style="">:</span>fac3 <span style="">+</span> fac1<span style="">:</span>fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
out2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1 <span style="">+</span> fac2 <span style="">+</span> fac3 <span style="">+</span> fac1<span style="">:</span>fac2 <span style="">+</span> fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
myvec <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>fac1<span style="color: #339933;">,</span> fac2<span style="color: #339933;">,</span> fac3<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> fac1<span style="">==</span><span style="color: #0000ff;">'No'</span><span style="color: #339933;">,</span> fac1<span style="">==</span><span style="color: #0000ff;">'Ru'</span><span style="color: #339933;">,</span> fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span> fac3<span style="">==</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>fac1<span style="">==</span><span style="color: #0000ff;">'No'</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>fac1<span style="">==</span><span style="color: #0000ff;">'Ru'</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #009900;">&#40;</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>fac3<span style="">==</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># calculate treatment means using model</span>
fac.vals2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">&#40;</span>fac1=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Co'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'No'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Ru'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> fac2=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> fac3=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
cmat <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> myvec<span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
ests <span style="">&lt;-</span> cmat<span style="">%*%</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
vmat <span style="">&lt;-</span> cmat <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>cmat<span style="color: #009900;">&#41;</span>
se <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
low95 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
up95 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.975</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
results.mine <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="color: #339933;">,</span> ests<span style="color: #339933;">,</span> se<span style="color: #339933;">,</span> low95<span style="color: #339933;">,</span> up95<span style="color: #009900;">&#41;</span>
results.mine<span style="">$</span>fac1.num <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="">$</span>fac1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># generate graph from last time for sibship 1</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3.2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;up95&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;low95&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'n'</span><span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">&quot;Hormonal treatment&quot;</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'Mean mitotic activity'</span><span style="color: #339933;">,</span> axes=F<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> at=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="">$</span>fac1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/box"><span style="color: #003399; font-weight: bold;">box</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
results.mine.sub1 <span style="">&lt;-</span> results.mine<span style="color: #009900;">&#91;</span>results.mine<span style="">$</span>fac3<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#first food group</span>
cur.dat <span style="">&lt;-</span> results.mine.sub1<span style="color: #009900;">&#91;</span>results.mine.sub1<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#amount of shift</span>
myjitter <span style="">&lt;-</span> <span style="">-</span><span style="color: #cc66cc;">.05</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low95<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up95<span style="color: #339933;">,</span> angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span> code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#second food group</span>
cur.dat <span style="">&lt;-</span> results.mine.sub1<span style="color: #009900;">&#91;</span>results.mine.sub1<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
myjitter <span style="">&lt;-</span> <span style="color: #cc66cc;">.05</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low95<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up95<span style="color: #339933;">,</span> angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span> code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Sibship 1'</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/legend"><span style="color: #003399; font-weight: bold;">legend</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'topleft'</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Detritus'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Shrimp'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span> pt.cex=<span style="color: #cc66cc;">.9</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/title"><span style="color: #003399; font-weight: bold;">title</span></a>=<a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/grDevices/bold"><span style="color: #003399; font-weight: bold;">bold</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Food Type'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> bty=<span style="color: #0000ff;">'n'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># function to calculate difference-adjusted confidence intervals</span>
ci.func <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>rowvals<span style="color: #339933;">,</span> lm.model<span style="color: #339933;">,</span> glm.vmat<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
nor.func1a <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>alpha<span style="color: #339933;">,</span> model<span style="color: #339933;">,</span> sig<span style="color: #009900;">&#41;</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pt"><span style="color: #003399; font-weight: bold;">pt</span></a><span style="color: #009900;">&#40;</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span>alpha<span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> model<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span> <span style="">*</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>sig<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="">/</span> <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> sig <span style="">%*%</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a> <span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> model<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span> <span style="">-</span> <a href="http://inside-r.org/r-doc/stats/pt"><span style="color: #003399; font-weight: bold;">pt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span>alpha<span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> model<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span> <span style="">*</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>sig<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="">/</span> <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> sig <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> model<span style="">$</span>df.residual<span style="color: #339933;">,</span> lower.tail=F<span style="color: #009900;">&#41;</span>
nor.func2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>a<span style="color: #339933;">,</span>model<span style="color: #339933;">,</span>sigma<span style="color: #009900;">&#41;</span> nor.func1a<span style="color: #009900;">&#40;</span>a<span style="color: #339933;">,</span>model<span style="color: #339933;">,</span>sigma<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">.95</span>
n <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span>rowvals<span style="color: #009900;">&#41;</span>
xvec1b <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/numeric"><span style="color: #003399; font-weight: bold;">numeric</span></a><span style="color: #009900;">&#40;</span>n<span style="">*</span><span style="color: #009900;">&#40;</span>n<span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
vmat <span style="">&lt;-</span> glm.vmat<span style="color: #009900;">&#91;</span>rowvals<span style="color: #339933;">,</span>rowvals<span style="color: #009900;">&#93;</span>
ind <span style="">&lt;-</span> <span style="color: #cc66cc;">1</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>i <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #009900;">&#40;</span>n<span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<span style="color: #000000; font-weight: bold;">for</span><span style="color: #009900;">&#40;</span>j <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #009900;">&#40;</span>i<span style="">+</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="">:</span>n<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
sig <span style="">&lt;-</span> vmat<span style="color: #009900;">&#91;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>i<span style="color: #339933;">,</span>j<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#solve for alpha</span>
xvec1b<span style="color: #009900;">&#91;</span>ind<span style="color: #009900;">&#93;</span> <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/uniroot"><span style="color: #003399; font-weight: bold;">uniroot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> nor.func2<span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> lm.model<span style="color: #339933;">,</span> sig<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.001</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.999</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">$</span>root
ind <span style="">&lt;-</span> ind<span style="">+</span><span style="color: #cc66cc;">1</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#125;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span>xvec1b
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># confidence levels for all 12*11/2 = 66 mean comparisons</span>
ci.func<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #339933;">, </span>out2<span style="color: #339933;">,</span> vmat<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># look only at first six means, the ones for sibship 1</span>
fac.vals2
ci.func<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">, </span>out2<span style="color: #339933;">,</span> vmat<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># calculate 75% and 83.5% confidence intervals</span>
low95 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
low75 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">.75</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
up75 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">.75</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
low83 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">.835</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
up83 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">.835</span><span style="color: #009900;">&#41;</span><span style="">/</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
&nbsp;
<span style="color: #666666; font-style: italic;"># add them to the data frame</span>
results.mine <span style="">&lt;- </span><a href="http://inside-r.org/r-doc/base/cbind"><span style="color: #003399; font-weight: bold;">cbind</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="color: #339933;">,</span>low75<span style="color: #339933;">,</span>up75<span style="color: #339933;">,</span>low83<span style="color: #339933;">,</span>up83<span style="color: #009900;">&#41;</span>
results.mine
&nbsp;
<span style="color: #666666; font-style: italic;"># add difference-adjusted cis to the graph</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>lend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3.2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;up95&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;low95&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'n'</span><span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">&quot;Hormonal treatment&quot;</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'Mean mitotic activity'</span><span style="color: #339933;">,</span> axes=F<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> at=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="">$</span>fac1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/box"><span style="color: #003399; font-weight: bold;">box</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
results.mine.sub1 <span style="">&lt;-</span> results.mine<span style="color: #009900;">&#91;</span>results.mine<span style="">$</span>fac3<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#first food group</span>
cur.dat <span style="">&lt;-</span> results.mine.sub1<span style="color: #009900;">&#91;</span>results.mine.sub1<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#amount of shift</span>
myjitter <span style="">&lt;-</span> <span style="">-</span><span style="color: #cc66cc;">.05</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low95<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up95<span style="color: #339933;">,</span> angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span> code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<span class="r geshifilter-R" style="font-family:monospace;">
<span style="color: #666666; font-style: italic;">#difference-adjusted confidence intervals</span></span>
<a href="http://inside-r.org/r-doc/graphics/segments"><span style="color: #003399; font-weight: bold;">segments</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low83<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up83<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'lightpink3'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/segments"><span style="color: #003399; font-weight: bold;">segments</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low75<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up75<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'red4'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">8</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">15</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">22</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#second food group</span>
cur.dat <span style="">&lt;-</span> results.mine.sub1<span style="color: #009900;">&#91;</span>results.mine.sub1<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
myjitter <span style="">&lt;-</span> <span style="color: #cc66cc;">.05</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low95<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up95<span style="color: #339933;">,</span> angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span> code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span>
<span class="r geshifilter-R" style="font-family:monospace;">
<span style="color: #666666; font-style: italic;">#difference-adjusted confidence intervals</span></span>
<a href="http://inside-r.org/r-doc/graphics/segments"><span style="color: #003399; font-weight: bold;">segments</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low83<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up83<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'lightblue'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/segments"><span style="color: #003399; font-weight: bold;">segments</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low75<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up75<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'dodgerblue4'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">8</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Sibship 1'</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/legend"><span style="color: #003399; font-weight: bold;">legend</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'topleft'</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Detritus'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Shrimp'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">22</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span> pt.cex=<span style="color: #cc66cc;">.9</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/title"><span style="color: #003399; font-weight: bold;">title</span></a>=<a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/grDevices/bold"><span style="color: #003399; font-weight: bold;">bold</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Food Type'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> bty=<span style="color: #0000ff;">'n'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># the seq function generates a vector of number with equal increments</span>
<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">3.3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add grid lines to graph</span>
<a href="http://inside-r.org/r-doc/graphics/abline"><span style="color: #003399; font-weight: bold;">abline</span></a><span style="color: #009900;">&#40;</span>h=<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">3.3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey70'</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># repeat graph with only one set of difference adjusted cis</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>lend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3.2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;up95&quot;</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">&quot;low95&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'n'</span><span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">&quot;Hormonal treatment&quot;</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'Mean mitotic activity'</span><span style="color: #339933;">,</span> axes=F<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> at=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="">$</span>fac1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/box"><span style="color: #003399; font-weight: bold;">box</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
results.mine.sub1 <span style="">&lt;-</span> results.mine<span style="color: #009900;">&#91;</span>results.mine<span style="">$</span>fac3<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#first food group</span>
cur.dat <span style="">&lt;-</span> results.mine.sub1<span style="color: #009900;">&#91;</span>results.mine.sub1<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;">#amount of shift</span>
myjitter <span style="">&lt;-</span> <span style="">-</span><span style="color: #cc66cc;">.05</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low95<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up95<span style="color: #339933;">,</span> angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span> code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;
<span class="r geshifilter-R" style="font-family:monospace;">
<span style="color: #666666; font-style: italic;">#difference-adjusted confidence intervals</span></span></span>
<a href="http://inside-r.org/r-doc/graphics/segments"><span style="color: #003399; font-weight: bold;">segments</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low83<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up83<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'lightpink3'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#segments(cur.dat$fac1.num+myjitter, cur.dat$low75, cur.dat$fac1.num+myjitter, cur.dat$up75, col='red4', lwd=8)</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">15</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">22</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#second food group</span>
cur.dat <span style="">&lt;-</span> results.mine.sub1<span style="color: #009900;">&#91;</span>results.mine.sub1<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
myjitter <span style="">&lt;-</span> <span style="color: #cc66cc;">.05</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low95<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up95<span style="color: #339933;">,</span> angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span> code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;
<span class="r geshifilter-R" style="font-family:monospace;">
<span style="color: #666666; font-style: italic;">#difference-adjusted confidence intervals</span></span></span>
<a href="http://inside-r.org/r-doc/graphics/segments"><span style="color: #003399; font-weight: bold;">segments</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>low83<span style="color: #339933;">,</span> cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>up83<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'lightblue'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">5</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#segments(cur.dat$fac1.num+myjitter, cur.dat$low75, cur.dat$fac1.num+myjitter, cur.dat$up75, col='dodgerblue4', lwd=8)</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1.num<span style="">+</span>myjitter<span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">4</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span>side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span> <span style="color: #0000ff;">'Sibship 1'</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/legend"><span style="color: #003399; font-weight: bold;">legend</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'topleft'</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Detritus'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Shrimp'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">22</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.8</span><span style="color: #339933;">,</span> pt.cex=<span style="color: #cc66cc;">.9</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/graphics/title"><span style="color: #003399; font-weight: bold;">title</span></a>=<a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/grDevices/bold"><span style="color: #003399; font-weight: bold;">bold</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Food Type'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> bty=<span style="color: #0000ff;">'n'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/abline"><span style="color: #003399; font-weight: bold;">abline</span></a><span style="color: #009900;">&#40;</span>h=<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">3.3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey70'</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># confidence levels for the second set of means</span>
ci.func<span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span>out2<span style="color: #339933;">,</span>vmat<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">7</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">7</span><span style="">:</span><span style="color: #cc66cc;">12</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span class="r geshifilter-R" style="font-family:monospace;">
<span style="color: #666666; font-style: italic;">#all pairwise comparisons</span></span>
&nbsp;
<span style="color: #666666; font-style: italic;"># function taken from web to create a matrix of 0s and 1s</span>
p.table = <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> g<span style="color: #339933;">,</span> p.adjust.method = <span style="color: #0000ff;">&quot;none&quot;</span><span style="color: #339933;">,</span> ...<span style="color: #339933;">,</span> level = <span style="color: #cc66cc;">0.05</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> 
  <span style="color: #666666; font-style: italic;">## fill out p-value table </span>
  p = <a href="http://inside-r.org/r-doc/stats/pairwise.t.test"><span style="color: #003399; font-weight: bold;">pairwise.t.test</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> g<span style="color: #339933;">,</span> p.adjust.method<span style="color: #339933;">,</span> ...<span style="color: #009900;">&#41;</span><span style="">$</span>p.value 
  p<span style="color: #009900;">&#91;</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span> = <span style="color: #cc66cc;">0</span> 
  p = <a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399; font-weight: bold;">rbind</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/cbind"><span style="color: #003399; font-weight: bold;">cbind</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #339933;">,</span> <span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> 
  p = p <span style="">+</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> 
  <span style="color: #666666; font-style: italic;">## 0 = no difference, 1 = difference </span>
  p = <span style="color: #cc66cc;">1</span> <span style="">*</span> <span style="color: #009900;">&#40;</span>p <span style="">&lt;=</span> level<span style="color: #009900;">&#41;</span> 
  <a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> = <span style="color: #cc66cc;">0</span> 
  <span style="color: #666666; font-style: italic;">## get means and find their order </span>
  m = <a href="http://inside-r.org/r-doc/base/tapply"><span style="color: #003399; font-weight: bold;">tapply</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> g<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a><span style="color: #009900;">&#41;</span> 
  o = <a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">&#40;</span>m<span style="color: #009900;">&#41;</span> 
  p = p<span style="color: #009900;">&#91;</span>o<span style="color: #339933;">,</span> o<span style="color: #009900;">&#93;</span> 
  <a href="http://inside-r.org/r-doc/base/dimnames"><span style="color: #003399; font-weight: bold;">dimnames</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> = <a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>m<span style="color: #009900;">&#91;</span>o<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>m<span style="color: #009900;">&#91;</span>o<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> 
  <a href="http://inside-r.org/r-doc/base/cbind"><span style="color: #003399; font-weight: bold;">cbind</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/mean"><span style="color: #003399; font-weight: bold;">mean</span></a> = m<span style="color: #009900;">&#91;</span>o<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> p<span style="color: #009900;">&#41;</span> 
  <span style="color: #009900;">&#125;</span>
<span class="r geshifilter-R" style="font-family:monospace;">
<span style="color: #666666; font-style: italic;">#use function on treatment means</span></span>
p.table<span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #339933;">,</span>tadpoles<span style="">$</span>treatment<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># we need to remove missing values first</span>
tadpoles2<span style="">&lt;-</span>tadpoles<span style="color: #009900;">&#91;</span><span style="">!</span><a href="http://inside-r.org/r-doc/base/is.na"><span style="color: #003399; font-weight: bold;">is.na</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>response<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">&#40;</span>tadpoles2<span style="color: #009900;">&#41;</span>
p.table<span style="color: #009900;">&#40;</span>tadpoles2<span style="">$</span>response<span style="color: #339933;">, </span>tadpoles2<span style="">$</span>treatment<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#classify means into groups based on pairwise diffs table</span>
diffs <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'a'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'a'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'a'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'b'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'c'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'c'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'cd'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'cd'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'cd'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'de'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'ef'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'f'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#obtaining treatment means</span>
out0 <span style="">&lt;- </span><a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>treatment<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out0<span style="color: #009900;">&#41;</span>
out0a<span style=""> &lt;- </span><a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>treatment<span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out0a<span style="color: #009900;">&#41;</span>
out0b<span style=""> &lt;- </span><a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1<span style="">:</span>fac2<span style="">:</span>fac3<span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out0b<span style="color: #009900;">&#41;</span>
&nbsp;<span class="r geshifilter-R" style="font-family:monospace;">
<span style="color: #666666; font-style: italic;">#dynamite graph
</span></span>
<span style="color: #666666; font-style: italic;"># sort means in ascending order</span>
my.means<span style=""> &lt;- </span><a href="http://inside-r.org/r-doc/base/sort"><span style="color: #003399; font-weight: bold;">sort</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out0a<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
my.means
&nbsp;
<span style="color: #666666; font-style: italic;"># sort std errs in same order as the means</span>
se.temp <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out0a<span style="color: #009900;">&#41;</span><span style="">$</span>coefficients<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span>
se.temp2 <span style="">&lt;-</span> se.temp<span style="color: #009900;">&#91;</span><a href="http://inside-r.org/r-doc/base/order"><span style="color: #003399; font-weight: bold;">order</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out0a<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span>

<span style="color: #666666; font-style: italic;"># rescale means so error bars show up on graph</span>
dat1<span style=""> &lt;- </span>my.means<span style="">-</span><span style="color: #cc66cc;">3</span>
<span style="color: #666666; font-style: italic;"># create bar plot and save coordinates of bars</span>
bp <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>dat1<span style="color: #339933;">,</span> axes=F<span style="color: #339933;">,</span> ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1.6</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> names.arg=<a href="http://inside-r.org/r-doc/base/substr"><span style="color: #003399; font-weight: bold;">substr</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>my.means<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/nchar"><span style="color: #003399; font-weight: bold;">nchar</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>my.means<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span>cex.names=<span style="color: #cc66cc;">0.8</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add correct labels on y-axis (because of rescaling)</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> at=<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1.4</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1.4</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.2</span><span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add handles to dynamite plot</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>x0=bp<span style="color: #339933;">,</span>y0=dat1<span style="color: #339933;">,</span>x1=bp<span style="color: #339933;">,</span>y1=dat1<span style="">+</span>se.temp2<span style="color: #339933;">,</span>angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">0.1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add labels to the handles</span>
<a href="http://inside-r.org/r-doc/graphics/text"><span style="color: #003399; font-weight: bold;">text</span></a><span style="color: #009900;">&#40;</span>bp<span style="color: #339933;">,</span> dat1<span style="">+</span>se.temp2<span style="color: #339933;">,</span> diffs<span style="color: #339933;">,</span> pos=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
