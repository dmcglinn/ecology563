<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 4</title>
</head>

<body>

<h2 align="center">R Code for Lecture 4 (Wednesday, September 5, 2012)</h2>
<div style="overflow:auto;"><div class="geshifilter">
<pre class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#fit tadpoles model</span>
tadpoles <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.table"><span style="color: #003399; font-weight: bold;">read.table</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;ecol 563/tadpoles.csv&quot;</span><span style="color: #339933;">,</span> header=T<span style="color: #339933;">,</span> sep=<span style="color: #0000ff;">','</span><span style="color: #009900;">&#41;</span>
tadpoles<span style="">$</span>fac3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>tadpoles<span style="">$</span>fac3<span style="color: #009900;">&#41;</span>
out1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1 <span style="">+</span> fac2 <span style="">+</span> fac3 <span style="">+</span> fac1<span style="">:</span>fac2 <span style="">+</span> fac1<span style="">:</span>fac3 <span style="">+</span> fac2<span style="">:</span>fac3 <span style="">+</span> fac1<span style="">:</span>fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
out2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/lm"><span style="color: #003399; font-weight: bold;">lm</span></a><span style="color: #009900;">&#40;</span>response<span style="">~</span>fac1 <span style="">+</span> fac2 <span style="">+</span> fac3 <span style="">+</span> fac1<span style="">:</span>fac2  <span style="">+</span> fac2<span style="">:</span>fac3<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=tadpoles<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># components of summary object</span>
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># summary table</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span><span style="">$</span>coefficients
&nbsp;
<span style="color: #666666; font-style: italic;"># extract effect estimates and std errs (omit intercept)</span>
ests <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span><span style="">$</span>coefficients<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span>
std.errs <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span><span style="">$</span>coefficients<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># degrees of freedom for confidence intervals</span>
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
out2<span style="">$</span>df.residual
&nbsp;
<span style="color: #666666; font-style: italic;">#confidence intervals</span>
low95 <span style="">&lt;-</span> ests<span style="">+</span><a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #339933;">,</span> out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>std.errs
up95 <span style="">&lt;-</span> ests<span style="">+</span><a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.975</span><span style="color: #339933;">,</span> out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>std.errs
low95
up95
&nbsp;
<span style="color: #666666; font-style: italic;"># can also obtain confidence intervals with confint function</span>
<a href="http://inside-r.org/r-doc/stats/confint"><span style="color: #003399; font-weight: bold;">confint</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#assemble components in a single data frame</span>
<span style="color: #666666; font-style: italic;"># make a factor in which main effects are listed first</span>
new.data <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>var.labels=<a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>ests<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a>=<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>ests<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> ests<span style="color: #339933;">,</span> low95<span style="color: #339933;">,</span> up95<span style="color: #009900;">&#41;</span>
new.data
<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>var.labels<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># in base graphics dotchart; in lattice graphics dotplot</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lattice"><span style="">lattice</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/dotchart"><span style="color: #003399; font-weight: bold;">dotchart</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=new.data<span style="">$</span>var.labels<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Effect estimates'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/dotplot"><span style="color: #003399; font-weight: bold;">dotplot</span></a><span style="color: #009900;">&#40;</span>var.labels<span style="">~</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=new.data<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Effect estimates'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Effects graph using lattice graphics</span>
&nbsp;
<a href="http://inside-r.org/r-doc/lattice/dotplot"><span style="color: #003399; font-weight: bold;">dotplot</span></a><span style="color: #009900;">&#40;</span>var.labels<span style="">~</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=new.data<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Effect estimates'</span><span style="color: #339933;">,</span> xlim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>low95<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">.02</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>up95<span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #cc66cc;">.02</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
<span style="color: #666666; font-style: italic;"># use dotplot to get gridlines</span>
<a href="http://inside-r.org/r-doc/lattice/panel.dotplot"><span style="color: #003399; font-weight: bold;">panel.dotplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add confidence intervals</span>
<a href="http://inside-r.org/r-doc/lattice/panel.segments"><span style="color: #003399; font-weight: bold;">panel.segments</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>low95<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> new.data<span style="">$</span>up95<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add points</span>
<a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #339933;">,</span>pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span>cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add vertical line at zero</span>
<a href="http://inside-r.org/r-doc/lattice/panel.abline"><span style="color: #003399; font-weight: bold;">panel.abline</span></a><span style="color: #009900;">&#40;</span>v=<span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Use same color for intervals and point estimates. Change bar ends to butted</span>
<a href="http://inside-r.org/r-doc/lattice/dotplot"><span style="color: #003399; font-weight: bold;">dotplot</span></a><span style="color: #009900;">&#40;</span>var.labels<span style="">~</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=new.data<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Effect estimates'</span><span style="color: #339933;">,</span> xlim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>low95<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">.02</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>up95<span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #cc66cc;">.02</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.dotplot"><span style="color: #003399; font-weight: bold;">panel.dotplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">, </span>y<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #009900;">&#41;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.segments"><span style="color: #003399; font-weight: bold;">panel.segments</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>low95<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span>new.data<span style="">$</span>up95<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">&quot;#0080ff&quot;</span><span style="color: #339933;">,</span> lineend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #339933;">,</span>pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span>cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.abline"><span style="color: #003399; font-weight: bold;">panel.abline</span></a><span style="color: #009900;">&#40;</span>v=<span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
 <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># math expressions for y-axis labels</span>
mylabel<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Normal'</span><span style="color: #339933;">, </span><span style="color: #0000ff;">'Ru486'</span><span style="color: #339933;">,</span><span style="color: #0000ff;"> 'Shrimp'</span><span style="color: #339933;">, </span><span style="color: #0000ff;">'Sibship'</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Normal'</span><span style="">%*%</span><span style="color: #0000ff;">'Shrimp'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Ru486'</span><span style="">%*%</span><span style="color: #0000ff;">'Shrimp'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/expression"><span style="color: #003399; font-weight: bold;">expression</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Shrimp'</span><span style="">%*%</span><span style="color: #0000ff;">'Sibship'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
mylabel
&nbsp;
<span style="color: #666666; font-style: italic;"># change labels on y-axis</span>
<a href="http://inside-r.org/r-doc/lattice/dotplot"><span style="color: #003399; font-weight: bold;">dotplot</span></a><span style="color: #009900;">&#40;</span>var.labels<span style="">~</span>ests<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=new.data<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Effect estimates'</span><span style="color: #339933;">,</span> xlim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/min"><span style="color: #003399; font-weight: bold;">min</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>low95<span style="color: #009900;">&#41;</span><span style="">-</span><span style="color: #cc66cc;">.02</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>up95<span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #cc66cc;">.02</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>y<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.dotplot"><span style="color: #003399; font-weight: bold;">panel.dotplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">, </span>y<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'white'</span><span style="color: #009900;">&#41;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.segments"><span style="color: #003399; font-weight: bold;">panel.segments</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>low95<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> new.data<span style="">$</span>up95<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>y<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">&quot;#0080ff&quot;</span><span style="color: #339933;">,</span> lineend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span>
 <a href="http://inside-r.org/r-doc/lattice/panel.abline"><span style="color: #003399; font-weight: bold;">panel.abline</span></a><span style="color: #009900;">&#40;</span>v=<span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
 <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span> scales=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>y=<a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>at=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">7</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=mylabel<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># demonstration of mathematical typesetting in R</span>
<a href="http://inside-r.org/r-doc/utils/demo"><span style="color: #003399; font-weight: bold;">demo</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/grDevices/plotmath"><span style="color: #003399; font-weight: bold;">plotmath</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Effects graph using base graphics</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># x-axis limits</span>
<a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>new.data<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># set limits for x-axis and y-axis</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>new.data<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">.3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">7</span><span style="">+</span><span style="color: #cc66cc;">.3</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#set up graph but without plotting</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>new.data<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">.3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">7</span><span style="">+</span><span style="color: #cc66cc;">.3</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'n'</span><span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Effect estimates'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">''</span><span style="color: #339933;">,</span>axes=F<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># x-axis</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># y-axis</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> at=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">7</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=mylabel<span style="color: #339933;">,</span> las=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/box"><span style="color: #003399; font-weight: bold;">box</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># increase margins on left</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;mar&quot;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">&quot;mar&quot;</span><span style="color: #009900;">&#41;</span><span style="">-&gt;</span>oldmar
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/mAr"><span style="">mar</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">5.1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">8.1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4.1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2.1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># redo graph</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>new.data<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="">:</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">.3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">7</span><span style="">+</span><span style="color: #cc66cc;">.3</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'n'</span><span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Effect estimates'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">''</span><span style="color: #339933;">,</span>axes=F<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> at=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">7</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=mylabel<span style="color: #339933;">,</span> las=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/box"><span style="color: #003399; font-weight: bold;">box</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># create a numeric variable for the labels</span>
new.data<span style="">$</span>num.labels <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>var.labels<span style="color: #009900;">&#41;</span>
new.data
<span style="color: #666666; font-style: italic;"># change bar ends to butted (from default round)</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span>lend=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># confidence intervals</span>
<a href="http://inside-r.org/r-doc/graphics/segments"><span style="color: #003399; font-weight: bold;">segments</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>low95<span style="color: #339933;">,</span> new.data<span style="">$</span>num.labels<span style="color: #339933;">,</span> new.data<span style="">$</span>up95<span style="color: #339933;">,</span> new.data<span style="">$</span>num.labels<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">&quot;#0080ff&quot;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># point estimates</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>new.data<span style="">$</span>ests<span style="color: #339933;">, </span>new.data<span style="">$</span>num.labels<span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">1.2</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">&quot;#0080ff&quot;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># vertical line at zero</span>
<a href="http://inside-r.org/r-doc/graphics/abline"><span style="color: #003399; font-weight: bold;">abline</span></a><span style="color: #009900;">&#40;</span>v=<span style="color: #cc66cc;">0</span><span style="color: #339933;">, </span>lty=<span style="color: #cc66cc;">2</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add grid lines to graph</span>
<a href="http://inside-r.org/r-doc/graphics/grid"><span style="color: #003399; font-weight: bold;">grid</span></a><span style="color: #009900;">&#40;</span>nx=<span style="color: #000000; font-weight: bold;">NA</span><span style="color: #339933;">,</span> ny=<span style="color: #000000; font-weight: bold;">NULL</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">&quot;grey70&quot;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#reset margins</span>
<a href="http://inside-r.org/r-doc/graphics/par"><span style="color: #003399; font-weight: bold;">par</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/mAr"><span style="">mar</span></a>=oldmar<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#### Obtaining treament means and their confidence intervals #####</span>
&nbsp;
<span style="color: #666666; font-style: italic;">## Method 1: use the effects package</span>
&nbsp;
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/effects"><span style="color: #003399; font-weight: bold;">effects</span></a><span style="color: #009900;">&#41;</span>
effect<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'fac1:fac2'</span><span style="color: #339933;">, </span>out2<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
ef1a &lt;- <span style="color: #003399; font-weight: bold;">effect</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'fac1:fac2'</span><span style="color: #339933;">, </span>out2<span style="color: #339933;">,</span> given.values=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>fac32=<span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> se=T<span style="color: #009900;">&#41;</span><span style=""></span>
ef2a &lt;- <span style="color: #003399; font-weight: bold;">effect</span><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'fac1:fac2'</span><span style="color: #339933;">, </span>out2<span style="color: #339933;">,</span> given.values=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>fac32=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> se=T<span style="color: #009900;">&#41;</span><span style=""></span>
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>ef1a<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#treatment means</span>
ef1a<span style="">$</span>fit
<span style="color: #666666; font-style: italic;"># standard errors of means</span>
ef1a<span style="">$</span>se
&nbsp;
<span style="color: #666666; font-style: italic;"># 95% confidence intervals</span>
ef1a<span style="">$</span>lower
ef1a<span style="">$</span>upper
&nbsp;
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span>ef1a<span style="color: #339933;">,</span>multiline=T<span style="color: #009900;">&#41;</span>
&nbsp;
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>ef1a<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># factor levels</span>
ef1a<span style="">$</span>x
&nbsp;
<span style="color: #666666; font-style: italic;"># mean statistics for sibship 1</span>
part1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>ef1a<span style="">$</span>x<span style="color: #339933;">,</span> fac3=<span style="color: #cc66cc;">1</span><span style="color: #339933;">, </span>est=ef1a<span style="">$</span>fit<span style="color: #339933;">,</span> se=ef1a<span style="">$</span>se<span style="color: #339933;">,</span>low95=ef1a<span style="">$</span>lower<span style="color: #339933;">,</span> up95=ef1a<span style="">$</span>upper<span style="color: #009900;">&#41;</span>
part1
<span style="color: #666666; font-style: italic;"># mean statistics for sibship 2</span>
part2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>ef2a<span style="">$</span>x<span style="color: #339933;">, </span>fac3=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> est=ef2a<span style="">$</span>fit<span style="color: #339933;">, </span>se=ef2a<span style="">$</span>se<span style="color: #339933;">,</span>low95=ef2a<span style="">$</span>lower<span style="color: #339933;">, </span>up95=ef2a<span style="">$</span>upper<span style="color: #009900;">&#41;</span>
part2
<span style="color: #666666; font-style: italic;"># combine both sibships in a single matrix</span>
part.eff <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399; font-weight: bold;">rbind</span></a><span style="color: #009900;">&#40;</span>part1<span style="color: #339933;">, </span>part2<span style="color: #009900;">&#41;</span>
part.eff
&nbsp;
<span style="color: #666666; font-style: italic;"># Method 2: obtain means and std errs using predict function</span>
fac.vals2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">&#40;</span>fac1=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Co'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'No'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Ru'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> fac2=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> fac3=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
fac.vals2
&nbsp;
<span style="color: #666666; font-style: italic;">#we need to convert fac3 to a factor or we get an error message</span>
out.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span> newdata=fac.vals2<span style="color: #339933;">,</span> se.fit=T<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/interval"><span style="">interval</span></a>=<span style="color: #0000ff;">&quot;confidence&quot;</span><span style="color: #009900;">&#41;</span>
fac.vals2<span style="">$</span>fac3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/factor"><span style="color: #003399; font-weight: bold;">factor</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="">$</span>fac3<span style="color: #009900;">&#41;</span>
out.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span> newdata=fac.vals2<span style="color: #339933;">,</span> se.fit=T<span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/interval"><span style="">interval</span></a>=<span style="color: #0000ff;">&quot;confidence&quot;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>out.p<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#estimated means and CIs</span>
out.p<span style="">$</span>fit
<span style="color: #666666; font-style: italic;">#standard error of means</span>
out.p<span style="">$</span>se.fit
results.pred <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="color: #339933;">, </span>out.p<span style="">$</span>fit<span style="color: #339933;">,</span> out.p<span style="">$</span>se.fit<span style="color: #009900;">&#41;</span>
results.pred
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>results.pred<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">4</span><span style="">:</span><span style="color: #cc66cc;">7</span><span style="color: #009900;">&#93;</span><span style=""> &lt;- </span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'est'</span><span style="color: #339933;">, </span><span style="color: #0000ff;">'low95'</span><span style="color: #339933;">, </span><span style="color: #0000ff;">'up95'</span><span style="color: #339933;">,</span><span style="color: #0000ff;"> 'se'</span><span style="color: #009900;">&#41;</span>
results.pred
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># Method 3: obtain means and std errs by hand</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#function to create dummy vector </span>
myvec <span style="">&lt;- </span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>fac1<span style="color: #339933;">, </span>fac2<span style="color: #339933;">,</span> fac3<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">, </span>fac1<span style="">==</span><span style="color: #0000ff;">'No'</span><span style="color: #339933;">, </span>fac1<span style="">==</span><span style="color: #0000ff;">'Ru'</span><span style="color: #339933;">, </span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span> fac3<span style="">==</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #009900;"> &#40;</span>fac1<span style="">==</span><span style="color: #0000ff;">'No'</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><span style="color: #009900;">&#40;</span>fac1<span style="">==</span><span style="color: #0000ff;">'Ru'</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span><span style="color: #009900;">&#40;</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>fac3<span style="">==</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
myvec<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Co'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
myvec<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Co'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># means for different treatments</span>
myvec<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Co'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
myvec<span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'No'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span>
fac.vals2
<span style="color: #666666; font-style: italic;">#obtain dummy vectors for each treatment</span>
<a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="color: #339933;">, </span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> myvec<span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;">#make dummy vectors the rows of a matrix</span>
<a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="color: #339933;">,</span><span style="color: #cc66cc;"> 1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> myvec<span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#contrast matrix</span>
cmat &lt;- <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="color: #339933;">,</span><span style="color: #cc66cc;"> 1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> myvec<span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span>x<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style=""></span>
&nbsp;
<span style="color: #666666; font-style: italic;">#treatment means</span>
ests &lt;- cmat<span style="">%*%</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span><span style=""></span>
ests
&nbsp;
<span style="color: #666666; font-style: italic;">#variance-covariance matrix of treatment means</span>
vmat &lt;- cmat <span style="">%*%</span> <a href="http://inside-r.org/r-doc/stats/vcov"><span style="color: #003399; font-weight: bold;">vcov</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #009900;">&#41;</span> <span style="">%*%</span> <a href="http://inside-r.org/r-doc/base/t"><span style="color: #003399; font-weight: bold;">t</span></a><span style="color: #009900;">&#40;</span>cmat<span style="color: #009900;">&#41;</span><span style=""></span>
<a href="http://inside-r.org/r-doc/base/dim"><span style="color: #003399; font-weight: bold;">dim</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># std errs of means</span>
se <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sqrt"><span style="color: #003399; font-weight: bold;">sqrt</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/diag"><span style="color: #003399; font-weight: bold;">diag</span></a><span style="color: #009900;">&#40;</span>vmat<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
se
&nbsp;
<span style="color: #666666; font-style: italic;"># 95% confidence intervals</span>
low95 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.025</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
up95 <span style="">&lt;-</span> ests <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/qt"><span style="color: #003399; font-weight: bold;">qt</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.975</span><span style="color: #339933;">,</span>out2<span style="">$</span>df.residual<span style="color: #009900;">&#41;</span><span style="">*</span>se
&nbsp;
<span style="color: #666666; font-style: italic;">#assemble results in data frame</span>
results.mine<span style=""> &lt;- </span><a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>fac.vals2<span style="color: #339933;">,</span> ests<span style="color: #339933;">,</span> se<span style="color: #339933;">,</span> low95<span style="color: #339933;">, </span>up95<span style="color: #009900;">&#41;</span>
results.mine
&nbsp;
<span style="color: #666666; font-style: italic;">#create a numeric version of the fac1 for plotting</span>
results.mine<span style="">$</span>fac1num <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>results.mine<span style="">$</span>fac1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#restrict data to sibship 1</span>
results.mine.sub <span style="">&lt;-</span> results.mine<span style="color: #009900;">&#91;</span>results.mine<span style="">$</span>fac3<span style="">==</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
results.mine.sub
&nbsp;
<span style="color: #666666; font-style: italic;">#set up axes for interaction graph</span>
<a href="http://inside-r.org/r-doc/graphics/plot"><span style="color: #003399; font-weight: bold;">plot</span></a><span style="color: #009900;">&#40;</span>ests<span style="">~</span>fac1num<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=results.mine.sub<span style="color: #339933;">,</span> xlim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3.2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">, </span>ylim=<a href="http://inside-r.org/r-doc/base/range"><span style="color: #003399; font-weight: bold;">range</span></a><span style="color: #009900;">&#40;</span>results.mine.sub<span style="color: #009900;">&#91;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="">:</span><span style="color: #cc66cc;">7</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'Mean mitotic activity'</span><span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Hormonal treatment'</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'n'</span><span style="color: #339933;">,</span> axes=F<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/axis"><span style="color: #003399; font-weight: bold;">axis</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> at=<span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a>=<a href="http://inside-r.org/r-doc/base/levels"><span style="color: #003399; font-weight: bold;">levels</span></a><span style="color: #009900;">&#40;</span>results.mine.sub<span style="">$</span>fac1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/box"><span style="color: #003399; font-weight: bold;">box</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># shift amount for plotted profiles</span>
jitter<span style=""> &lt;- </span><span style="color: #cc66cc;">0.05</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#Detritus profile</span>
cur.dat<span style="">&lt;-</span>results.mine.sub<span style="color: #009900;">&#91;</span>results.mine.sub<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'D'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1num<span style="">-</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">,</span> cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;"> col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1num<span style="">-</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">, </span>cur.dat<span style="">$</span>ests<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1num<span style="">-</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">, </span>cur.dat<span style="">$</span>low95<span style="color: #339933;">, </span>cur.dat<span style="">$</span>fac1num<span style="">-</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">, </span>cur.dat<span style="">$</span>up95<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #339933;">, </span>code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">, </span>angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#Shrimp profile</span>
cur.dat<span style="">&lt;-</span>results.mine.sub<span style="color: #009900;">&#91;</span>results.mine.sub<span style="">$</span>fac2<span style="">==</span><span style="color: #0000ff;">'S'</span><span style="color: #339933;">,</span><span style="color: #009900;">&#93;</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1num<span style="">+</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">, </span>cur.dat<span style="">$</span>ests<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">15</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/lines"><span style="color: #003399; font-weight: bold;">lines</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1num<span style="">+</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">, </span>cur.dat<span style="">$</span>ests<span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> lty=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/arrows"><span style="color: #003399; font-weight: bold;">arrows</span></a><span style="color: #009900;">&#40;</span>cur.dat<span style="">$</span>fac1num<span style="">+</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">, </span>cur.dat<span style="">$</span>low95<span style="color: #339933;">, </span>cur.dat<span style="">$</span>fac1num<span style="">+</span><a href="http://inside-r.org/r-doc/base/jitter"><span style="color: #003399; font-weight: bold;">jitter</span></a><span style="color: #339933;">, </span>cur.dat<span style="">$</span>up95<span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> code=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> angle=<span style="color: #cc66cc;">90</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a>=<span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#legend and margin text</span>
<a href="http://inside-r.org/r-doc/graphics/legend"><span style="color: #003399; font-weight: bold;">legend</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'topleft'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Detritus'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Shrimp'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> pch=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">15</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> lty=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> pt.cex=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #339933;">,</span> bty=<span style="color: #0000ff;">'n'</span><span style="color: #339933;">, </span><a href="http://inside-r.org/r-doc/graphics/title"><span style="color: #003399; font-weight: bold;">title</span></a>=<span style="color: #0000ff;">'Food type'</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/graphics/mtext"><span style="color: #003399; font-weight: bold;">mtext</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Sibship 1'</span><span style="color: #339933;">,</span> side=<span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/line"><span style="color: #003399; font-weight: bold;">line</span></a>=<span style="color: #cc66cc;">.5</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
