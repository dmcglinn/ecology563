<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 18</title>
</head>

<body>

<h2 align="center">R Code for Lecture 18 (Wednesday, October 24, 2012)</h2>
<div style="overflow:auto;">
  <div class="geshifilter">
  <pre class="r geshifilter-R" style="font-family:monospace;">slugs <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.table"><span style="color: #003399; font-weight: bold;">read.table</span></a><span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">'http://www.bio.ic.ac.uk/research/mjcraw/statcomp/data/slugsurvey.txt'</span><span style="color: #339933;">,</span> header=<span style="color: #000000; font-weight: bold;">TRUE</span><span style="color: #009900;">&#41;</span>
slug.table <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span>
slugtable <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
slugtable<span style="">$</span>Var1.num <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.character"><span style="color: #003399; font-weight: bold;">as.character</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># common mean Poisson model</span>
pois1.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
LL<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span>lambda=p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
LL
<span style="color: #009900;">&#125;</span>
negpois1.LL<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
<span style="">-</span>pois1.LL<span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
out.pois1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negpois1.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1.2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># separate means Poisson model</span>
pois2.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">&quot;Rookery&quot;</span><span style="color: #009900;">&#41;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> lambda=mu<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
LL
<span style="color: #009900;">&#125;</span>
negpois2.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
<span style="">-</span>pois2.LL<span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
out.pois2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negpois2.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1.2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># model 1: single mean negative binomial model</span>
negNB1.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span>
theta <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> mu=mu<span style="color: #339933;">,</span> size=theta<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL
<span style="color: #009900;">&#125;</span>
&nbsp;
out.NB1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negNB1.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.NB1
&nbsp;
<span style="color: #666666; font-style: italic;"># model 2: two means negative binomial model</span>
negNB2.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span>
theta <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> mu=mu<span style="color: #339933;">,</span> size=theta<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain estimates</span>
out.NB2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negNB2.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.NB2
&nbsp;
<span style="color: #666666; font-style: italic;"># model 3: single mean, two dispersions negative binomial model</span>
negNB3.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> 
theta <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> mu=mu<span style="color: #339933;">,</span> size=theta<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL
<span style="color: #009900;">&#125;</span>
<span style="color: #666666; font-style: italic;"># obtain estimates</span>
out.NB3 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negNB3.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.NB3
&nbsp;
<span style="color: #666666; font-style: italic;"># model 4: two means, two dispersions negative binomial model</span>
negNB4.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span>
theta <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> mu=mu<span style="color: #339933;">,</span> size=theta<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain estimates</span>
out.NB4 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negNB4.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.NB4
&nbsp;
<span style="color: #666666; font-style: italic;"># collect log-likelihoods of the various models</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>out.pois1<span style="color: #339933;">,</span>out.pois2<span style="color: #339933;">,</span>out.NB1<span style="color: #339933;">,</span>out.NB2<span style="color: #339933;">,</span>out.NB3<span style="color: #339933;">,</span>out.NB4<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <span style="">-</span>x<span style="">$</span>minimum<span style="color: #009900;">&#41;</span>
LL
<span style="color: #666666; font-style: italic;"># count number of estimated parameters</span>
k <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>out.pois1<span style="color: #339933;">,</span>out.pois2<span style="color: #339933;">,</span>out.NB1<span style="color: #339933;">,</span>out.NB2<span style="color: #339933;">,</span>out.NB3<span style="color: #339933;">,</span>out.NB4<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span>x<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
k
&nbsp;
labels<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Pois1'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'Pois2'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'NB1'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'NB2'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'NB3'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'NB4'</span><span style="color: #009900;">&#41;</span>
output <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a><span style="color: #339933;">,</span>LL<span style="color: #339933;">,</span>k<span style="color: #009900;">&#41;</span>
output
&nbsp;
<span style="color: #666666; font-style: italic;">#### fit the models using standard R functions ####</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># Poisson model with identity link versus log link</span>
<a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#40;</span>link=<a href="http://inside-r.org/r-doc/base/identity"><span style="color: #003399; font-weight: bold;">identity</span></a><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># Poisson models</span>
glm.pois1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
glm.pois2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># negative binomial models with common dispersion</span>
&nbsp;
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/MASS"><span style="">MASS</span></a><span style="color: #009900;">&#41;</span>
glm.NB1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/MASS/glm.nb"><span style="color: #003399; font-weight: bold;">glm.nb</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #009900;">&#41;</span>
glm.NB2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/MASS/glm.nb"><span style="color: #003399; font-weight: bold;">glm.nb</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># negative binomial models with separate dispersions</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/gamlss"><span style="">gamlss</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/utils/help"><span style="color: #003399; font-weight: bold;">help</span></a>=<a href="http://inside-r.org/packages/cran/gamlss"><span style="">gamlss</span></a><span style="color: #009900;">&#41;</span>
<span style="">?</span><a href="http://inside-r.org/packages/cran/gamlss"><span style="">gamlss</span></a>
glm.NB3 <span style="">&lt;-</span> <a href="http://inside-r.org/packages/cran/gamlss"><span style="">gamlss</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> sigma.formula=<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=NBI<span style="color: #009900;">&#41;</span>
glm.NB3
&nbsp;
<span style="color: #666666; font-style: italic;"># log-likelihoods match</span>
<span style="">-</span>out.NB3<span style="">$</span>minimum
<a href="http://inside-r.org/r-doc/stats/logLik"><span style="color: #003399; font-weight: bold;">logLik</span></a><span style="color: #009900;">&#40;</span>glm.NB3<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># parameter estimates</span>
out.NB3<span style="">$</span>estimate
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>glm.NB3<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/utils/methods"><span style="color: #003399; font-weight: bold;">methods</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#41;</span>
<span style="">?</span>coef.gamlss
&nbsp;
<span style="color: #666666; font-style: italic;"># to extract dispersion parameters we need to use the what argument</span>
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>glm.NB3<span style="color: #339933;">,</span>what=<span style="color: #0000ff;">'sigma'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># theta for nursery slugs</span>
out.NB3<span style="">$</span>estimate
<span style="color: #cc66cc;">1</span><span style="">/</span>exp<span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>glm.NB3<span style="color: #339933;">,</span> what=<span style="color: #0000ff;">'sigma'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#theta for rookery slugs</span>
<span style="color: #cc66cc;">1</span><span style="">/</span>exp<span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>glm.NB3<span style="color: #339933;">,</span> what=<span style="color: #0000ff;">'sigma'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>out.NB3<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="">:</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># separate dispersions and separate means</span>
glm.NB4 <span style="">&lt;-</span> <a href="http://inside-r.org/packages/cran/gamlss"><span style="">gamlss</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> sigma.formula=<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=NBI<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># log-likelihoods</span>
<a href="http://inside-r.org/r-doc/stats/logLik"><span style="color: #003399; font-weight: bold;">logLik</span></a><span style="color: #009900;">&#40;</span>glm.NB4<span style="color: #009900;">&#41;</span>
<span style="">-</span>out.NB4<span style="">$</span>minimum
&nbsp;
<span style="color: #666666; font-style: italic;"># collect log-likelihoods together</span>
LL.glm <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>glm.pois1<span style="color: #339933;">,</span>glm.pois2<span style="color: #339933;">,</span>glm.NB1<span style="color: #339933;">,</span>glm.NB2<span style="color: #339933;">,</span>glm.NB3<span style="color: #339933;">,</span>glm.NB4<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/logLik"><span style="color: #003399; font-weight: bold;">logLik</span></a><span style="color: #009900;">&#41;</span>
LL.glm
LL
<span style="color: #666666; font-style: italic;"># number of estimated parameters for Poisson models</span>
k.pois <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>glm.pois1<span style="color: #339933;">,</span>glm.pois2<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># number of estimated parameters for glm.nb models</span>
k.nb <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>glm.NB1<span style="color: #339933;">,</span>glm.NB2<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">+</span><span style="color: #cc66cc;">1</span>
<span style="color: #666666; font-style: italic;"># number of estimated parameters for gamlss models</span>
k.gamlss <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>glm.NB3<span style="color: #339933;">,</span>glm.NB4<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span> <span style="">+</span> <a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span>what=<span style="color: #0000ff;">'sigma'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
k.glm <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>k.pois<span style="color: #339933;">,</span> k.nb<span style="color: #339933;">,</span> k.gamlss<span style="color: #009900;">&#41;</span>
&nbsp;
<a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/labels"><span style="color: #003399; font-weight: bold;">labels</span></a><span style="color: #339933;">,</span> k=k.glm<span style="color: #339933;">,</span> LL=LL.glm<span style="color: #009900;">&#41;</span>
output
&nbsp;
<span style="color: #666666; font-style: italic;"># LR test comparing Pois2 and Pois1: beta1 = 0</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>glm.pois1<span style="color: #339933;">,</span>glm.pois2<span style="color: #339933;">,</span>test=<span style="color: #0000ff;">'Chisq'</span><span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># conclusion: reject Pois1</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># compare NB2 and Pois2</span>
<span style="color: #666666; font-style: italic;"># LR-test for testing a boundary condition, 1/theta = 0</span>
output
<span style="color: #666666; font-style: italic;"># LR statistic</span>
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># critical value</span>
<span style="color: #cc66cc;">.5</span><span style="">*</span><a href="http://inside-r.org/r-doc/stats/qchisq"><span style="color: #003399; font-weight: bold;">qchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.95</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># p-value</span>
<span style="color: #cc66cc;">.5</span><span style="">*</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># conclusion: reject Pois2</span>

<span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># compare NB1 and Pois1</span>
<span style="color: #666666; font-style: italic;"># LR-test for testing a boundary condition, 1/theta = 0</span>
<span style="color: #666666; font-style: italic;"># LR statistic</span>
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;&#41;</span>
<span style="color: #666666; font-style: italic;"># critical value</span>
<span style="color: #cc66cc;">.5</span><span style="">*</span><a href="http://inside-r.org/r-doc/stats/qchisq"><span style="color: #003399; font-weight: bold;">qchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.95</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># p-value</span>
<span style="color: #cc66cc;">.5</span><span style="">*</span><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;&#41;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;&#41;</span></span>
<span style="color: #666666; font-style: italic;"># conclusion: reject Pois1</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># compare NB1 and NB2: beta1 = 0</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>glm.NB1<span style="color: #339933;">,</span>glm.NB2<span style="color: #339933;">,</span>test=<span style="color: #0000ff;">'Chisq'</span><span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># conclusion: reject NB2</span><span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #009900;"></span></span>

<span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># compare NB1 and NB3: theta1 = 0</span><a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;"></span></a>
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span></span>
<span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># conclusion: reject NB1</span></span>

<span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># compare NB4 and NB2: theta</span>1=0
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/qchisq"><span style="color: #003399; font-weight: bold;">qchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.95</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># conclusion: reject NB2</span><span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #009900;"></span></span></span></span>
&nbsp;
<span style="color: #666666; font-style: italic;"># compare NB3 and NB4: beta1 = 0</span>
<span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="">*</span><span style="color: #009900;">&#40;</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>LL<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="">-</span>output<span style="">$</span>k<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">5</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span class="r geshifilter-R" style="font-family:monospace;"><span style="color: #666666; font-style: italic;"># conclusion: reject NB4</span></span>
&nbsp;&nbsp;
<span style="color: #666666; font-style: italic;"># obtain expected counts of NB3 model</span>
<span style="color: #666666; font-style: italic;"># mean</span>
slugtable<span style="">$</span>mu <span style="">&lt;-</span> out.NB3<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span>
<span style="color: #666666; font-style: italic;"># theta</span>
slugtable<span style="">$</span>theta <span style="">&lt;-</span> out.NB3<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span> <span style="">+</span> out.NB3<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var2<span style="">==</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># calculate NB probabilities of each count</span>
slugtable<span style="">$</span>p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1.num<span style="color: #339933;">,</span> mu=slugtable<span style="">$</span>mu<span style="color: #339933;">,</span> size=slugtable<span style="">$</span>theta<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">11</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># add tail probability to X=10 category</span>
slugtable<span style="">$</span>p2 <span style="">&lt;-</span> slugtable<span style="">$</span>p <span style="">+</span> <a href="http://inside-r.org/r-doc/stats/pnbinom"><span style="color: #003399; font-weight: bold;">pnbinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span> mu=slugtable<span style="">$</span>mu<span style="color: #339933;">,</span> size=slugtable<span style="">$</span>theta<span style="color: #339933;">,</span> lower.tail=F<span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1.num<span style="">==</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span>
slugtable
&nbsp;
<span style="color: #666666; font-style: italic;"># create a data frame of sample sizes</span>
<a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
n.data <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
n.data
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>n.data<span style="color: #009900;">&#41; </span><span style="">&lt;- </span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #0000ff;">'Var2'</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'n'</span><span style="color: #009900;">&#41;</span>
n.data
&nbsp;
<span style="color: #666666; font-style: italic;"># add samples sizes to data set</span>
slugtable2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/merge"><span style="color: #003399; font-weight: bold;">merge</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="color: #339933;">,</span>n.data<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># calculate expected counts</span>
slugtable2<span style="">$</span>exp <span style="">&lt;-</span> slugtable2<span style="">$</span>n<span style="">*</span>slugtable2<span style="">$</span>p2
slugtable2
&nbsp;
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lattice"><span style="">lattice</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>Freq<span style="">~</span>Var1.num<span style="">|</span>Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugtable2<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Count category'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">,</span> subscripts<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span> lineend=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># NB3 counts</span>
<a href="http://inside-r.org/r-doc/lattice/panel.points"><span style="color: #003399; font-weight: bold;">panel.points</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> slugtable2<span style="">$</span>exp<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.6</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'o'</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
