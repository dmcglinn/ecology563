<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 15</title>
</head>

<body>

<h2 align="center">R Code for Lecture 15 (Monday, October 15, 2012)</h2>
<div style="overflow:auto;"><div class="geshifilter">
  <pre class="r geshifilter-R" style="font-family:monospace;">num.stems <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># data frame of tabulated data</span>
aphids <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>aphids=<span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> counts=num.stems<span style="color: #009900;">&#41;</span>
aphids
<a href="http://inside-r.org/r-doc/base/names"><span style="color: #003399; font-weight: bold;">names</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#41;</span> <span style="">&lt;-</span> <span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span>
<a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#41;</span>
aphid.data <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/rep"><span style="color: #003399; font-weight: bold;">rep</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span>num.stems<span style="color: #009900;">&#41;</span>
aphid.data
poisson.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>lambda<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="color: #339933;">,</span> lambda<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
poisson.negloglik <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>lambda<span style="color: #009900;">&#41;</span> <span style="">-</span>poisson.LL<span style="color: #009900;">&#40;</span>lambda<span style="color: #009900;">&#41;</span>
out.pois <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>poisson.negloglik<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
out.pois
&nbsp;
<span style="color: #666666; font-style: italic;"># Poisson regression with log link</span>
out.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.p<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.p<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Poisson regression with identity link</span>
out.p1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>aphid.data<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#40;</span>link=<a href="http://inside-r.org/r-doc/base/identity"><span style="color: #003399; font-weight: bold;">identity</span></a><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.p1<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Poisson probabilities</span>
<a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># expected counts</span>
<a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #cc66cc;">50</span>
<span style="color: #666666; font-style: italic;"># missing tail probability</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># include tail probability</span>
<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># expected counts</span>
<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #cc66cc;">50</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># counts with extra category for X &gt; 9</span>
<a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399; font-weight: bold;">rbind</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #339933;">,</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">9</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #cc66cc;">50</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># counts in which last category is 9 or more</span>
<a href="http://inside-r.org/r-doc/base/rbind"><span style="color: #003399; font-weight: bold;">rbind</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #cc66cc;">50</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># expected Poisson counts</span>
exp.pois <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #cc66cc;">50</span>
exp.pois
&nbsp;
<span style="color: #666666; font-style: italic;"># two different ways to calculate the last category</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> out.pois<span style="">$</span>estimate<span style="color: #339933;">,</span> lower.tail=F<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># bar plot with pooled last category</span>
out.bar <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/graphics/barplot"><span style="color: #003399; font-weight: bold;">barplot</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #339933;">,</span> names.arg=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span><span style="color: #0000ff;">'9+'</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> ylim=<a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">11</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># x-coordinates of midpoint of bar</span>
out.bar
<span style="color: #666666; font-style: italic;"># add expected counts to bar plot</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span>out.bar<span style="color: #339933;">,</span> exp.pois<span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'o'</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.9</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># expected probabilities</span>
expected.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
expected.p
&nbsp;
<span style="color: #666666; font-style: italic;"># pool categories so all expected counts exceed 5</span>
expected2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>exp.pois<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> exp.pois<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>exp.pois<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">7</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
expected2
<span style="color: #666666; font-style: italic;"># repeat process with observed counts</span>
observed2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> num.stems<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">7</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
observed2
&nbsp;
<span style="color: #666666; font-style: italic;"># Pearson statistic</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>observed2<span style="">-</span>expected2<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>expected2<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span>observed2<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># critical value of test statistic</span>
<a href="http://inside-r.org/r-doc/stats/qchisq"><span style="color: #003399; font-weight: bold;">qchisq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">.95</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">6</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># p-value of test statistic</span>
<span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/pchisq"><span style="color: #003399; font-weight: bold;">pchisq</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>observed2<span style="">-</span>expected2<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>expected2<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">6</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="">-</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># repeat using chisq.test function</span>
exp.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
exp.p
expected2.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>exp.p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> exp.p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="">:</span><span style="color: #cc66cc;">6</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>exp.p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">7</span><span style="">:</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
expected2.p
<a href="http://inside-r.org/r-doc/stats/chisq.test"><span style="color: #003399; font-weight: bold;">chisq.test</span></a><span style="color: #009900;">&#40;</span>observed2<span style="color: #339933;">,</span> p=expected2.p<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># without pooling chisq.test issues a warning</span>
actual.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0</span><span style="">:</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span> lambda=out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="">-</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">8</span><span style="color: #339933;">,</span>out.pois<span style="">$</span>estimate<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
actual.p
<a href="http://inside-r.org/r-doc/stats/chisq.test"><span style="color: #003399; font-weight: bold;">chisq.test</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #339933;">,</span> p=actual.p<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># parametric bootstrap</span>
out.sim <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/chisq.test"><span style="color: #003399; font-weight: bold;">chisq.test</span></a><span style="color: #009900;">&#40;</span>num.stems<span style="color: #339933;">,</span> p=actual.p<span style="color: #339933;">,</span> simulate.p.value=T<span style="color: #339933;">,</span> B=<span style="color: #cc66cc;">9999</span><span style="color: #009900;">&#41;</span>
out.sim</pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
