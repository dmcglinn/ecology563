<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>R code for lecture 17</title>
</head>

<body>

<h2 align="center">R Code for Lecture 17 (Monday, October 22, 2012)</h2>
<div style="overflow:auto;"><div class="geshifilter"><pre class="r geshifilter-R" style="font-family:monospace;">slugs <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/utils/read.table"><span style="color: #003399; font-weight: bold;">read.table</span></a><span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">'http://www.bio.ic.ac.uk/research/mjcraw/statcomp/data/slugsurvey.txt'</span><span style="color: #339933;">,</span> header=<span style="color: #000000; font-weight: bold;">TRUE</span><span style="color: #009900;">&#41;</span>
slug.table <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span>
slugtable <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># numerical version of count variable</span>
slugtable<span style="">$</span>Var1.num <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/as.character"><span style="color: #003399; font-weight: bold;">as.character</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># single mean Poisson model negative log-likelihood</span>
negpois1.LL<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
LL<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> lambda=p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># separate means Poisson log-likelihood</span>
pois2.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">&quot;Rookery&quot;</span><span style="color: #009900;">&#41;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> lambda=mu<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
LL
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># negative log-likelihood</span>
negpois2.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#123;</span>
<span style="">-</span>pois2.LL<span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain estimates using nlm</span>
out.pois2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negpois2.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1.2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># obtain estimates using glm</span>
out2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># add predicted means to data frame</span>
slugtable<span style="">$</span>mu <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/predict"><span style="color: #003399; font-weight: bold;">predict</span></a><span style="color: #009900;">&#40;</span>out2<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'response'</span><span style="color: #339933;">,</span> newdata=<a href="http://inside-r.org/r-doc/base/data.frame"><span style="color: #003399; font-weight: bold;">data.frame</span></a><span style="color: #009900;">&#40;</span>field=slugtable<span style="">$</span>Var2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># calculate Poisson probabilities</span>
slugtable<span style="">$</span>p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1.num<span style="color: #339933;">,</span> lambda=slugtable<span style="">$</span>mu<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add tail probability to X = 10 category</span>
slugtable<span style="">$</span>p2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/dpois"><span style="color: #003399; font-weight: bold;">dpois</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1.num<span style="color: #339933;">,</span> lambda=slugtable<span style="">$</span>mu<span style="color: #009900;">&#41;</span><span style="">+</span><a href="http://inside-r.org/r-doc/stats/ppois"><span style="color: #003399; font-weight: bold;">ppois</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">10</span><span style="color: #339933;">,</span> lambda=slugtable<span style="">$</span>mu<span style="color: #339933;">,</span> lower.tail=F<span style="color: #009900;">&#41;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var1.num<span style="">==</span><span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># count the number of observations in each field type</span>
n <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/table"><span style="color: #003399; font-weight: bold;">table</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># calculate expected counts</span>
slugtable<span style="">$</span>exp <span style="">&lt;-</span> slugtable<span style="">$</span>p2 <span style="">*</span> n<span style="color: #009900;">&#91;</span><a href="http://inside-r.org/r-doc/base/as.numeric"><span style="color: #003399; font-weight: bold;">as.numeric</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Var2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#93;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># graph Poisson model and raw data</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/lattice"><span style="">lattice</span></a><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/xyplot"><span style="color: #003399; font-weight: bold;">xyplot</span></a><span style="color: #009900;">&#40;</span>Freq<span style="">~</span>Var1.num<span style="">|</span>Var2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugtable<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'Count category'</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/panel"><span style="">panel</span></a>=<a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">,</span> subscripts<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a href="http://inside-r.org/r-doc/lattice/panel.xyplot"><span style="color: #003399; font-weight: bold;">panel.xyplot</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> y<span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'h'</span><span style="color: #339933;">,</span> lineend=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #0000ff;">'grey'</span><span style="color: #339933;">,</span> lwd=<span style="color: #cc66cc;">10</span><span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/lattice/panel.points"><span style="color: #003399; font-weight: bold;">panel.points</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #339933;">,</span> slugtable<span style="">$</span>exp<span style="color: #009900;">&#91;</span>subscripts<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> cex=<span style="color: #cc66cc;">.6</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> type=<span style="color: #0000ff;">'o'</span><span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># split probabilities by field type</span>
slug.p <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/split"><span style="color: #003399; font-weight: bold;">split</span></a><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>p2<span style="color: #339933;">,</span> slugtable<span style="">$</span>Var2<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># simulate data for field=nursery</span>
<a href="http://inside-r.org/r-doc/stats/rmultinom"><span style="color: #003399; font-weight: bold;">rmultinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> size=n<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/prob"><span style="">prob</span></a>=slug.p<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># simulate data for field=rookery</span>
<a href="http://inside-r.org/r-doc/stats/rmultinom"><span style="color: #003399; font-weight: bold;">rmultinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> size=n<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/prob"><span style="">prob</span></a>=slug.p<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># Obtain simulations from both nursery and rookery</span>
<a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/stats/rmultinom"><span style="color: #003399; font-weight: bold;">rmultinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> size=n<span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/prob"><span style="">prob</span></a>=slug.p<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># convert matrix to a vector and save results</span>
out.obs <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/as.vector"><span style="color: #003399; font-weight: bold;">as.vector</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/stats/rmultinom"><span style="color: #003399; font-weight: bold;">rmultinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> size=n<span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/packages/cran/prob"><span style="">prob</span></a>=slug.p<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># calculate Pearson statistic using both field results</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>out.obs<span style="">-</span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># write things as a function that can be replicated</span>
myfunc <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
<a href="http://inside-r.org/r-doc/base/as.vector"><span style="color: #003399; font-weight: bold;">as.vector</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="">:</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>x<span style="color: #009900;">&#41;</span> <a href="http://inside-r.org/r-doc/stats/rmultinom"><span style="color: #003399; font-weight: bold;">rmultinom</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span>size=n<span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span><a href="http://inside-r.org/packages/cran/prob"><span style="">prob</span></a>=slug.p<span style="color: #009900;">&#91;</span><span style="color: #009900;">&#91;</span>x<span style="color: #009900;">&#93;</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">-&gt;</span>out.obs
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>out.obs<span style="">-</span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#41;</span>
<span style="color: #009900;">&#125;</span>
&nbsp;
myfunc<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># set random seed</span>
<a href="http://inside-r.org/r-doc/base/set.seed"><span style="color: #003399; font-weight: bold;">set.seed</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">23</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># obtain 9999 simulated Pearson statistics</span>
<a href="http://inside-r.org/r-doc/base/replicate"><span style="color: #003399; font-weight: bold;">replicate</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">9999</span><span style="color: #339933;">,</span> myfunc<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="">-&gt;</span>out.pearson
<a href="http://inside-r.org/r-doc/base/max"><span style="color: #003399; font-weight: bold;">max</span></a><span style="color: #009900;">&#40;</span>out.pearson<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># actual Pearson statistic</span>
actual <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Freq<span style="">-</span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#41;</span>
actual
&nbsp;
<span style="color: #666666; font-style: italic;">#obtain p-value</span>
out.pearson.all<span style="">&lt;-</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span>out.pearson<span style="color: #339933;">,</span>actual<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span>out.pearson.all<span style="">&gt;=</span>actual<span style="color: #009900;">&#41;</span><span style="">/</span>length<span style="color: #009900;">&#40;</span>out.pearson.all<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># what terms are causing the Pearson statistic to be so large: category X &gt;=10 in nursery</span>
<a href="http://inside-r.org/r-doc/base/round"><span style="color: #003399; font-weight: bold;">round</span></a><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#40;</span>slugtable<span style="">$</span>Freq<span style="">-</span>slugtable<span style="">$</span>exp<span style="color: #009900;">&#41;</span><span style="">^</span><span style="color: #cc66cc;">2</span><span style="">/</span>slugtable<span style="">$</span>exp<span style="color: #339933;">,</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># graphing the log-likelihood surface</span>
<span style="">?</span><a href="http://inside-r.org/r-doc/graphics/persp"><span style="color: #003399; font-weight: bold;">persp</span></a>
g <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/expand.grid"><span style="color: #003399; font-weight: bold;">expand.grid</span></a><span style="color: #009900;">&#40;</span>b0=<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> b1=<a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># calculate log-likelihood on a grid of possible values</span>
g<span style="">$</span>z <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/apply"><span style="color: #003399; font-weight: bold;">apply</span></a><span style="color: #009900;">&#40;</span>g<span style="color: #339933;">,</span> <span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> pois2.LL<span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># arrange z-coordinates in matrix to match x-y grid of values</span>
z.matrix <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/matrix"><span style="color: #003399; font-weight: bold;">matrix</span></a><span style="color: #009900;">&#40;</span>g<span style="">$</span>z<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/nrow"><span style="color: #003399; font-weight: bold;">nrow</span></a>=<a href="http://inside-r.org/r-doc/base/length"><span style="color: #003399; font-weight: bold;">length</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># graph surface</span>
<a href="http://inside-r.org/r-doc/graphics/persp"><span style="color: #003399; font-weight: bold;">persp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> z.matrix<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'b0'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'b1'</span><span style="color: #339933;">,</span> zlab=<span style="color: #0000ff;">'log-likelihood'</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add tick marks</span>
<a href="http://inside-r.org/r-doc/graphics/persp"><span style="color: #003399; font-weight: bold;">persp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> z.matrix<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'b0'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'b1'</span><span style="color: #339933;">,</span> zlab=<span style="color: #0000ff;">'log-likelihood'</span><span style="color: #339933;">,</span> ticktype=<span style="color: #0000ff;">&quot;detailed&quot;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># rotate around z-axis (theta) and in vertical plane (phi)</span>
<a href="http://inside-r.org/r-doc/graphics/persp"><span style="color: #003399; font-weight: bold;">persp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> z.matrix<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'b0'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'b1'</span><span style="color: #339933;">,</span> zlab=<span style="color: #0000ff;">'log-likelihood'</span><span style="color: #339933;">,</span> ticktype=<span style="color: #0000ff;">&quot;detailed&quot;</span><span style="color: #339933;">,</span> theta=<span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span> phi=<span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># save surface coordinates</span>
out.persp <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/graphics/persp"><span style="color: #003399; font-weight: bold;">persp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/seq"><span style="color: #003399; font-weight: bold;">seq</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">0.5</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">.05</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> z.matrix<span style="color: #339933;">,</span> xlab=<span style="color: #0000ff;">'b0'</span><span style="color: #339933;">,</span> ylab=<span style="color: #0000ff;">'b1'</span><span style="color: #339933;">,</span> zlab=<span style="color: #0000ff;">'log-likelihood'</span><span style="color: #339933;">,</span> ticktype=<span style="color: #0000ff;">&quot;detailed&quot;</span><span style="color: #339933;">,</span> theta=<span style="color: #cc66cc;">30</span><span style="color: #339933;">,</span> phi=<span style="color: #cc66cc;">30</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># obtain coordinates of projection of MLE onto graph</span>
<a href="http://inside-r.org/r-doc/grDevices/trans3d"><span style="color: #003399; font-weight: bold;">trans3d</span></a><span style="color: #009900;">&#40;</span>out.pois2<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> out.pois2<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="">-</span>out.pois2<span style="">$</span>minimum<span style="color: #339933;">,</span> out.persp<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># add maximum likelihood estimate to the graph</span>
<a href="http://inside-r.org/r-doc/graphics/points"><span style="color: #003399; font-weight: bold;">points</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/grDevices/trans3d"><span style="color: #003399; font-weight: bold;">trans3d</span></a><span style="color: #009900;">&#40;</span>out.pois2<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> out.pois2<span style="">$</span>estimate<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">,</span> <span style="">-</span>out.pois2<span style="">$</span>minimum<span style="color: #339933;">,</span> out.persp<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> pch=<span style="color: #cc66cc;">16</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/col"><span style="color: #003399; font-weight: bold;">col</span></a>=<span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span>
&nbsp;
&nbsp;
<span style="color: #666666; font-style: italic;"># model 1: single mean negative binomial model</span>
negNB.LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span>
theta <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> mu=mu<span style="color: #339933;">,</span> size=theta<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL
<span style="color: #009900;">&#125;</span>
negNB.LL<span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
negNB.LL<span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">4</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># model 2: two means negative binomial model</span>
negNB.LL2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/function"><span style="color: #003399; font-weight: bold;">function</span></a><span style="color: #009900;">&#40;</span>p<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>
mu <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span> <span style="">+</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="">*</span><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>field<span style="">==</span><span style="color: #0000ff;">'Rookery'</span><span style="color: #009900;">&#41;</span>
theta <span style="">&lt;-</span> p<span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #009900;">&#93;</span>
LL <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/base/sum"><span style="color: #003399; font-weight: bold;">sum</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/log"><span style="color: #003399; font-weight: bold;">log</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/dnbinom"><span style="color: #003399; font-weight: bold;">dnbinom</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">$</span>slugs<span style="color: #339933;">,</span> mu=mu<span style="color: #339933;">,</span> size=theta<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
<span style="">-</span>LL
<span style="color: #009900;">&#125;</span>
&nbsp;
negNB.LL2<span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain estimates</span>
out.NB1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negNB.LL<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.NB1
out.NB2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/nlm"><span style="color: #003399; font-weight: bold;">nlm</span></a><span style="color: #009900;">&#40;</span>negNB.LL2<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/base/c"><span style="color: #003399; font-weight: bold;">c</span></a><span style="color: #009900;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
out.NB2
&nbsp;
<span style="color: #666666; font-style: italic;"># fit model 1 using glm.nb function</span>
<a href="http://inside-r.org/r-doc/base/library"><span style="color: #003399; font-weight: bold;">library</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/packages/cran/MASS"><span style="">MASS</span></a><span style="color: #009900;">&#41;</span>
out.glm1 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/MASS/glm.nb"><span style="color: #003399; font-weight: bold;">glm.nb</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.glm1<span style="color: #009900;">&#41;</span>
out.NB1<span style="">$</span>estimate
<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.glm1<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># fit model 2 using glm.nb function</span>
out.glm2 <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/MASS/glm.nb"><span style="color: #003399; font-weight: bold;">glm.nb</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #009900;">&#41;</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.glm2<span style="color: #009900;">&#41;</span>
out.NB2<span style="">$</span>estimate
<span style="color: #666666; font-style: italic;"># nursery mean</span>
<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.glm2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># rookery mean</span>
<a href="http://inside-r.org/r-doc/base/exp"><span style="color: #003399; font-weight: bold;">exp</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.glm2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #009900;">&#93;</span><span style="">+</span><a href="http://inside-r.org/r-doc/stats/coef"><span style="color: #003399; font-weight: bold;">coef</span></a><span style="color: #009900;">&#40;</span>out.glm2<span style="color: #009900;">&#41;</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #009900;">&#93;</span><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># Poisson models: common mean and separate means models</span>
out.glm2a <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span>field<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
out.glm1a <span style="">&lt;-</span> <a href="http://inside-r.org/r-doc/stats/glm"><span style="color: #003399; font-weight: bold;">glm</span></a><span style="color: #009900;">&#40;</span>slugs<span style="">~</span><span style="color: #cc66cc;">1</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/utils/data"><span style="color: #003399; font-weight: bold;">data</span></a>=slugs<span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/family"><span style="color: #003399; font-weight: bold;">family</span></a>=<a href="http://inside-r.org/r-doc/stats/poisson"><span style="color: #003399; font-weight: bold;">poisson</span></a><span style="color: #009900;">&#41;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># obtain log-likelihoods of models</span>
<a href="http://inside-r.org/r-doc/base/sapply"><span style="color: #003399; font-weight: bold;">sapply</span></a><span style="color: #009900;">&#40;</span><a href="http://inside-r.org/r-doc/base/list"><span style="color: #003399; font-weight: bold;">list</span></a><span style="color: #009900;">&#40;</span>out.glm1<span style="color: #339933;">,</span> out.glm2<span style="color: #339933;">,</span> out.glm1a<span style="color: #339933;">,</span> out.glm2a<span style="color: #009900;">&#41;</span><span style="color: #339933;">,</span> <a href="http://inside-r.org/r-doc/stats/logLik"><span style="color: #003399; font-weight: bold;">logLik</span></a><span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># Wald test of field effect</span>
<a href="http://inside-r.org/r-doc/base/summary"><span style="color: #003399; font-weight: bold;">summary</span></a><span style="color: #009900;">&#40;</span>out.glm2<span style="color: #009900;">&#41;</span>
<span style="color: #666666; font-style: italic;"># likelihood ratio test of field effect</span>
<a href="http://inside-r.org/r-doc/stats/anova"><span style="color: #003399; font-weight: bold;">anova</span></a><span style="color: #009900;">&#40;</span>out.glm1<span style="color: #339933;">,</span> out.glm2<span style="color: #339933;">,</span> test=<span style="color: #0000ff;">'Chisq'</span><span style="color: #009900;">&#41;</span></pre></div></div><p><a href="http://www.inside-r.org/pretty-r" title="Created by Pretty R at inside-R.org">Created by Pretty R at inside-R.org</a></p>
</body>
</html>
